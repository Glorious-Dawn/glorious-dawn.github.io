{"version":3,"sources":["PageFrame.js","hooks.js","GachaToolPage.js","HomePage.js","component/GeneralTable.js","Strings.js","CollectionToolPage.js","hook/MutableSortedRows.js","App.js","serviceWorker.js","index.js","cv/tracking.js","cv/MatchWorker.js"],"names":["useStyles","makeStyles","theme","root","display","toolbar","paddingRight","toolbarIcon","alignItems","justifyContent","padding","mixins","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","width","enteringScreen","menuButton","marginRight","menuButtonHidden","title","flexGrow","drawerPaper","position","whiteSpace","drawerPaperClose","overflowX","spacing","breakpoints","up","appBarSpacer","content","height","overflow","container","paddingTop","paddingBottom","paper","flexDirection","fixedHeight","PageFrame","children","classes","React","useState","open","setOpen","className","CssBaseline","AppBar","clsx","Toolbar","IconButton","edge","color","aria-label","onClick","Typography","component","variant","noWrap","Badge","badgeContent","max","Drawer","Divider","List","ListItem","RouterLink","to","ListItemIcon","ListItemText","primary","Container","maxWidth","useInput","initialValue","value","setValue","reset","bind","onChange","event","target","bionomial_cdf","X","N","P","LogGamma","Z","S","Math","log","Betinc","A","B","C9","A0","B0","A1","B1","M9","A2","abs","bincdf","BT","floor","exp","calc_gacha_value","n","rewards","name","hasOwnProperty","r","calc_spark_value","vals","v","push","sort","a","b","prob","forEach","x","fail","NameInputDialog","description","handleCancel","handleConfirm","bindName","Dialog","onClose","aria-labelledby","DialogTitle","id","DialogContent","DialogContentText","TextField","autoFocus","margin","label","fullWidth","DialogActions","Button","RewardTable","setRewards","headers","raddN","bindRaddN","resetRaddN","raddP","bindRaddP","resetRaddP","raddV","bindRaddV","resetRaddV","handleSwitch","e","val","checked","rewardList","TableRow","key","TableCell","Switch","newVal","removeReward","TableContainer","Paper","Table","TableHead","disabled","map","h","TableBody","size","required","preventDefault","Number","RefValueTable","pulls","defaultRefValues","localStorage","getItem","setItem","JSON","stringify","parse","refValues","setRefValues","refValueName","bindRefValueName","selectedRefValue","setSelectedRefValue","pullsToSpark","valueSpark","value10","refValueRows","rv","style","background","round","filter","removeRefValue","GachaToolPage","bindPulls","spark_value","Grid","item","xs","md","lg","localProfiles","profiles","setProfiles","defaultSelected","pname","profileName","bindProfileName","resetProfileName","profile","bindProfile","profileList","MenuItem","select","newProfiles","ProfileSelect","HomePage","MatchedTable","props","items","i","handleDropFile","file","callBack","type","match","reader","FileReader","onload","image","Image","split","src","result","readAsDataURL","data","readAsText","loadImageDataOnCanvas","canvas","y","context","getContext","drawImage","getImageData","drawPoints","canvasContext","points","length","fillStyle","strokeStyle","fillRect","CollectionToolPage","compareFn","rowsRef","useRef","rows","setRows","upsert","newRows","current","p","findIndex","splice","remove","useMutableSortedRows","matchedItems","upsertMatchedItems","removeMatchedItems","mainCanvasRef","subCanvasRef","workersRef","nextWorkerRef","savedNamesRef","saved","setSaved","useEffect","worker","MatchWorker","onmessage","Strings","matches","console","terminate","subDropCallback","subImageData","postMessage","mainDropCallback","imageData","grayscale","tracking","corners","Fast","findCorners","descriptors","Brief","getDescriptors","dropzoneText","filesLimit","maxFileSize","Infinity","showPreviewsInDropzone","showAlerts","onDrop","Link","href","download","ref","hidden","join","App","path","exact","isLocalhost","Boolean","window","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","catch","error","ReactDOM","render","StrictMode","document","getElementById","URL","process","origin","addEventListener","fetch","response","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker","EventEmitter","prototype","events_","addListener","listener","TypeError","this","emit","listeners","args","Array","slice","call","arguments","apply","on","once","self","handlerInternal","removeListener","removeAllListeners","opt_event","isArray","setMaxListeners","Error","Canvas","loadImage","opt_callback","instance","img","crossOrigin","DisjointSet","undefined","parent","Uint32Array","find","union","j","iRepresentative","jRepresentative","blur","pixels","diameter","radius","len","ceil","weights","Float32Array","rho","rhoSq","gaussianFactor","sqrt","PI","rhoFactor","wsum","middle","gx","separableConvolve","computeIntegralImage","opt_integralImage","opt_integralImageSquare","opt_tiltedIntegralImage","opt_integralImageSobel","pixelsSobel","sobel","w","pixel","computePixelValueSAT_","w1","pixelAbove","computePixelValueRSAT_","RSAT","SAT","fillRGBA","gray","Uint8ClampedArray","horizontalConvolve","weightsVector","opaque","side","halfSide","output","alphaFac","sy","sx","offset","g","cx","poffset","min","wt","verticalConvolve","cy","horizWeights","vertWeights","vertical","sobelSignVector","sobelScaleVector","horizontal","ViolaJones","REGIONS_OVERLAP","classifiers","detect","initialScale","scaleFactor","stepSize","edgesDensity","integralImageSobel","total","rects","integralImage","Int32Array","integralImageSquare","tiltedIntegralImage","minWidth","minHeight","scale","blockWidth","blockHeight","step","isTriviallyExcluded","evalStages_","mergeRectangles_","wbA","wbB","wbD","wbC","inverseArea","mean","variance","standardDeviation","stageSum","stageThreshold","nodeLength","rectsSum","tilted","rectsLength","w2","w3","w4","rectLeft","rectTop","rectWidth","rectHeight","rectWeight","nodeThreshold","nodeLeft","nodeRight","disjointSet","r1","r2","intersectRect","x1","y1","overlap","area1","area2","k","rep","Object","keys","rect","randomImageOffsets_","randomWindowOffsets_","keypoints","descriptorWord","offsets","getRandomOffsets_","offsetsPosition","keypoints1","descriptors1","keypoints2","descriptors2","len1","len2","minj","dist","hammingWeight","index1","index2","keypoint1","keypoint2","confidence","reciprocalMatch","matches1","matches2","windowPosition","windowOffsets","uniformRandom","imagePosition","imageOffsets","THRESHOLD","circles_","opt_threshold","circleOffsets","getCircleOffsets_","circlePixels","isCorner","isBrighter","circlePixel","threshold","darker","brighter","isDarker","count","circleBottom","circleLeft","circleRight","circleTop","circle","distance","x0","y0","dx","dy","random","x2","y2","x3","y3","Matrix","fn","opt_jump","EPnP","solve","objectPoints","imagePoints","cameraMatrix","from","setRandomWindowOffsets","generateRandomWindowOffsets","module","exports","Worker"],"mappings":"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AAI,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,IAAI,GAAG,EAAE,IAAI,IAAI,IAAI,EAAE,IAAI,EAAE,IAAI,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,IAAI,EAAE,EAAE,IAAI,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,IAAI,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,IAAI,EAAE,EAAE,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,EAAE,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,IAAI,GAAG,IAAI,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,IAAI,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,GAAG,EAAE,IAAI,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,GAAG,EAAE,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,EAAE,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,IAAI,IAAI,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,IAAI,GAAG,EAAE,EAAE,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,IAAI,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,EAAE,GAAG,IAAI,EAAE,EAAE,GAAG,IAAI,IAAI,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,IAAI,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG,GAAG,IAAI,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,EAAE,EAAE,IAAI,GAAG,IAAI,IAAI,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,IAAI,GAAG,IAAI,EAAE,EAAE,IAAI,IAAI,GAAG,IAAI,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,IAAI,IAAI,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,IAAI,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,IAAI,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,IAAI,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,IAAI,IAAI,EAAE,IAAI,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,IAAI,IAAI,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,EAAE,IAAI,GAAG,IAAI,IAAI,IAAI,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,EAAE,IAAI,IAAI,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,IAAI,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,GAAG,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,EAAE,IAAI,IAAI,GAAG,EAAE,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,IAAI,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,IAAI,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,IAAI,IAAI,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,IAAI,EAAE,IAAI,GAAG,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,IAAI,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,IAAI,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,IAAI,IAAI,EAAE,EAAE,IAAI,EAAE,EAAE,IAAI,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,IAAI,IAAI,GAAG,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,IAAI,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,IAAI,EAAE,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,IAAI,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,IAAI,GAAG,IAAI,IAAI,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,GAAG,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,IAAI,IAAI,EAAE,EAAE,GAAG,IAAI,IAAI,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,EAAE,EAAE,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,EAAE,IAAI,GAAG,IAAI,EAAE,EAAE,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,IAG1vLrS,EAASK,MAAMiS,uBAAuB,SAAS1C,GAC7CrL,KAAK4J,oBAAoB,GACzB5J,KAAK6J,qBAAqBpD,WAAWqH,KAAKzC,IAG5C5P,EAASK,MAAMkS,4BAA4B,WAGzC,IAFA,IAAI5C,EAAiB,EACjBC,EAAgB,IAAI5E,WAAW,EAAIzG,KAAK7R,GACnCiJ,EAAI,EAAGA,EAAI4I,KAAK7R,EAAGiJ,IAC1BiU,EAAcD,KAAoB5c,KAAK8G,MAAMmG,EAASjN,KAAK8c,eAAe,GAAI,KAC9ED,EAAcD,KAAoB5c,KAAK8G,MAAMmG,EAASjN,KAAK8c,eAAe,GAAI,KAC9ED,EAAcD,KAAoB5c,KAAK8G,MAAMmG,EAASjN,KAAK8c,eAAe,GAAI,KAC9ED,EAAcD,KAAoB5c,KAAK8G,MAAMmG,EAASjN,KAAK8c,eAAe,GAAI,KAEhF,OAAOD,GAKX4C,EAAOC,QAAQzS,G,mBC77CfwS,EAAOC,QAAU,WACf,OAAO,IAAIC,OAAO,IAA0B,qC","file":"static/js/main.71ad7a7d.chunk.js","sourcesContent":["import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Badge from '@material-ui/core/Badge';\r\nimport Container from '@material-ui/core/Container';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport NotificationsIcon from '@material-ui/icons/Notifications';\r\n\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\n\r\nimport {\r\n    HashRouter as Router,\r\n    Link as RouterLink\r\n} from \"react-router-dom\";\r\n\r\nimport HomeIcon from '@material-ui/icons/Home';\r\nimport StarIcon from '@material-ui/icons/Star'\r\nimport CollectionsIcon from '@material-ui/icons/Collections';\r\n\r\nconst drawerWidth = 240;\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: 'flex',\r\n    },\r\n    toolbar: {\r\n        paddingRight: 24, // keep right padding when drawer closed\r\n    },\r\n    toolbarIcon: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'flex-end',\r\n        padding: '0 8px',\r\n        ...theme.mixins.toolbar,\r\n    },\r\n    appBar: {\r\n        zIndex: theme.zIndex.drawer + 1,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.leavingScreen,\r\n        }),\r\n    },\r\n    appBarShift: {\r\n        marginLeft: drawerWidth,\r\n        width: `calc(100% - ${drawerWidth}px)`,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen,\r\n        }),\r\n    },\r\n    menuButton: {\r\n        marginRight: 36,\r\n    },\r\n    menuButtonHidden: {\r\n        display: 'none',\r\n    },\r\n    title: {\r\n        flexGrow: 1,\r\n    },\r\n    drawerPaper: {\r\n        position: 'relative',\r\n        whiteSpace: 'nowrap',\r\n        width: drawerWidth,\r\n        transition: theme.transitions.create('width', {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen,\r\n        }),\r\n    },\r\n    drawerPaperClose: {\r\n        overflowX: 'hidden',\r\n        transition: theme.transitions.create('width', {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.leavingScreen,\r\n        }),\r\n        width: theme.spacing(7),\r\n        [theme.breakpoints.up('sm')]: {\r\n            width: theme.spacing(9),\r\n        },\r\n    },\r\n    appBarSpacer: theme.mixins.toolbar,\r\n    content: {\r\n        // backgroundImage: 'url(\"https://embed.pixiv.net/decorate.php?illust_id=60385957\")',\r\n        // background: 'no-repeat;',\r\n        // backgroundSize: 'cover',\r\n        // backgroundPosition: 'center',\r\n        flexGrow: 1,\r\n        height: '100vh',\r\n        overflow: 'auto',\r\n    },\r\n    container: {\r\n        paddingTop: theme.spacing(4),\r\n        paddingBottom: theme.spacing(4),\r\n    },\r\n    paper: {\r\n        padding: theme.spacing(2),\r\n        display: 'flex',\r\n        overflow: 'auto',\r\n        flexDirection: 'column',\r\n    },\r\n    fixedHeight: {\r\n        height: 240,\r\n    },\r\n}));\r\n\r\nexport default function PageFrame({title,children}) {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = React.useState(false);\r\n    const handleDrawerOpen = () => {\r\n        setOpen(true);\r\n    };\r\n    const handleDrawerClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    return (\r\n        <Router>\r\n            <div className={classes.root}>\r\n                <CssBaseline />\r\n                <AppBar position=\"absolute\" className={clsx(classes.appBar, open && classes.appBarShift)}>\r\n                    <Toolbar className={classes.toolbar}>\r\n                        <IconButton\r\n                            edge=\"start\"\r\n                            color=\"inherit\"\r\n                            aria-label=\"open drawer\"\r\n                            onClick={handleDrawerOpen}\r\n                            className={clsx(classes.menuButton, open && classes.menuButtonHidden)}\r\n                        >\r\n                            <MenuIcon />\r\n                        </IconButton>\r\n                        <Typography component=\"h1\" variant=\"h6\" color=\"inherit\" noWrap className={classes.title}>\r\n                            {title}\r\n                        </Typography>\r\n                        <IconButton color=\"inherit\">\r\n                            <Badge badgeContent={346} max={999} color=\"secondary\">\r\n                                <NotificationsIcon />\r\n                            </Badge>\r\n                        </IconButton>\r\n                    </Toolbar>\r\n                </AppBar>\r\n                <Drawer\r\n                    variant=\"permanent\"\r\n                    classes={{\r\n                        paper: clsx(classes.drawerPaper, !open && classes.drawerPaperClose),\r\n                    }}\r\n                    open={open}\r\n                >\r\n                    <div className={classes.toolbarIcon}>\r\n                        <IconButton onClick={handleDrawerClose}>\r\n                            <ChevronLeftIcon />\r\n                        </IconButton>\r\n                    </div>\r\n                    <Divider />\r\n                    <List>\r\n                        <ListItem component={RouterLink} to=\"/\">\r\n                            <ListItemIcon>\r\n                                <HomeIcon />\r\n                            </ListItemIcon>\r\n                            <ListItemText primary=\"Home\" />\r\n                        </ListItem>\r\n                        <ListItem component={RouterLink} to=\"/gacha\">\r\n                            <ListItemIcon>\r\n                                <StarIcon />\r\n                            </ListItemIcon>\r\n                            <ListItemText primary=\"Gacha\" />\r\n                        </ListItem>\r\n                        <ListItem component={RouterLink} to=\"/collection\">\r\n                            <ListItemIcon>\r\n                                <CollectionsIcon />\r\n                            </ListItemIcon>\r\n                            <ListItemText primary=\"Collection\" />\r\n                        </ListItem>\r\n                    </List>\r\n                </Drawer>\r\n                <main className={classes.content}>\r\n                    <div className={classes.appBarSpacer} />\r\n                    <Container maxWidth=\"xl\" className={classes.container}>\r\n                        {children}\r\n                    </Container>\r\n                </main>\r\n            </div>\r\n        </Router>\r\n    );\r\n}","import { useState, useRef, useEffect} from 'react';\r\n\r\nexport const useEventListener=(eventName, handler, element)=>{\r\n    // Create a ref that stores handler\r\n    const savedHandler = useRef();\r\n\r\n    // Update ref.current value if handler changes.\r\n    // This allows our effect below to always get latest handler ...\r\n    // ... without us needing to pass it in effect deps array ...\r\n    // ... and potentially cause effect to re-run every render.\r\n    useEffect(() => {\r\n        savedHandler.current = handler;\r\n    }, [handler]);\r\n\r\n    useEffect(\r\n        () => {\r\n            // Make sure element supports addEventListener\r\n            // On\r\n            const isSupported = element && element.addEventListener;\r\n            if (!isSupported) return;\r\n\r\n            // Create event listener that calls handler function stored in ref\r\n            const eventListener = event => savedHandler.current(event);\r\n\r\n            // Add event listener\r\n            element.addEventListener(eventName, eventListener);\r\n\r\n            // Remove event listener on cleanup\r\n            return () => {\r\n                element.removeEventListener(eventName, eventListener);\r\n            };\r\n        },\r\n        [eventName, element] // Re-run if eventName or element changes\r\n    );\r\n};\r\n\r\n\r\nexport const useInput = initialValue => {\r\n    const [value, setValue] = useState(initialValue);\r\n    return {\r\n        value,\r\n        setValue,\r\n        reset: () => setValue(\"\"),\r\n        bind: {\r\n            value,\r\n            onChange: event => {\r\n                setValue(event.target.value);\r\n            }\r\n        }\r\n    };\r\n};","import React, {useState} from 'react';\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\n\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\n\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport PageFrame from \"./PageFrame\";\r\n\r\nimport {useInput} from \"./hooks\"\r\n\r\n// Credit: https://www.math.ucla.edu/~tom/distributions/binomial.html\r\nfunction bionomial_cdf(X, N, P) {\r\n    function LogGamma(Z) {\r\n        let S = 1 + 76.18009173 / Z - 86.50532033 / (Z + 1) + 24.01409822 / (Z + 2) - 1.231739516 / (Z + 3) + .00120858003 / (Z + 4) - .00000536382 / (Z + 5);\r\n        let LG = (Z - .5) * Math.log(Z + 4.5) - (Z + 4.5) + Math.log(S * 2.50662827465);\r\n        return LG;\r\n    }\r\n\r\n    function Betinc(X, A, B) {\r\n        let A0 = 0;\r\n        let B0 = 1;\r\n        let A1 = 1;\r\n        let B1 = 1;\r\n        let M9 = 0;\r\n        let A2 = 0;\r\n        let C9;\r\n        while (Math.abs((A1 - A2) / A1) > .00001) {\r\n            A2 = A1;\r\n            C9 = -(A + M9) * (A + B + M9) * X / (A + 2 * M9) / (A + 2 * M9 + 1);\r\n            A0 = A1 + C9 * A0;\r\n            B0 = B1 + C9 * B0;\r\n            M9 = M9 + 1;\r\n            C9 = M9 * (B - M9) * X / (A + 2 * M9 - 1) / (A + 2 * M9);\r\n            A1 = A0 + C9 * A1;\r\n            B1 = B0 + C9 * B1;\r\n            A0 = A0 / B1;\r\n            B0 = B0 / B1;\r\n            A1 = A1 / B1;\r\n            B1 = 1;\r\n        }\r\n        return A1 / A;\r\n    }\r\n\r\n    let bincdf;\r\n    let Z, A, B, S, BT, Betacdf;\r\n    if (N <= 0) {\r\n        return 0;\r\n    } else if ((P < 0) || (P > 1)) {\r\n        return 0;\r\n    } else if (X < 0) {\r\n        bincdf = 0\r\n    } else if (X >= N) {\r\n        bincdf = 1\r\n    } else {\r\n        X = Math.floor(X);\r\n        Z = P;\r\n        A = X + 1;\r\n        B = N - X;\r\n        S = A + B;\r\n        BT = Math.exp(LogGamma(S) - LogGamma(B) - LogGamma(A) + A * Math.log(Z) + B * Math.log(1 - Z));\r\n        if (Z < (A + 1) / (S + 2)) {\r\n            Betacdf = BT * Betinc(Z, A, B)\r\n        } else {\r\n            Betacdf = 1 - BT * Betinc(1 - Z, B, A)\r\n        }\r\n        bincdf = 1 - Betacdf;\r\n    }\r\n    return bincdf;\r\n}\r\n\r\n// restrictions: sum of probability <=1\r\n// m: reward array, [reward, probability, value], sum(probability)<=1\r\n// b: bonus array, [tries, value]\r\n// n: num of tries\r\n// c: cost of each try\r\n// returns: value / cost\r\nfunction calc_gacha_value(n, rewards) {\r\n    let value = 0;\r\n    for (let name in rewards) {\r\n        if (!rewards.hasOwnProperty(name))\r\n            continue;\r\n        let r = rewards[name];\r\n        // Disabled reward\r\n        if (r[2] === false) continue;\r\n        let prob_get = 1 - bionomial_cdf(0, n, r[0]);\r\n        value += prob_get * r[1];\r\n    }\r\n    return value;\r\n}\r\n\r\n\r\nfunction calc_spark_value(n, rewards) {\r\n    let vals = [];\r\n    for (let name in rewards) {\r\n        if (!rewards.hasOwnProperty(name))\r\n            continue;\r\n        let v = rewards[name];\r\n        vals.push([(v[2] ? v[1] : 0), v[0]]);\r\n    }\r\n    vals.sort((a, b) => b[0] - a[0]);\r\n    let value = 0;\r\n    let prob = 1;\r\n    vals.forEach(x => {\r\n        let fail = bionomial_cdf(0, n, x[1]);\r\n        value += prob * fail * x[0];\r\n        prob *= (1 - fail);\r\n    });\r\n    return value;\r\n}\r\n\r\nfunction NameInputDialog(description, title, open, handleCancel, handleConfirm, bindName) {\r\n    return (\r\n        <Dialog open={open} onClose={handleCancel} aria-labelledby=\"form-dialog-title\">\r\n            <DialogTitle id=\"form-dialog-title\">Save Profile</DialogTitle>\r\n            <DialogContent>\r\n                <DialogContentText>\r\n                    {description}\r\n                </DialogContentText>\r\n                <TextField\r\n                    autoFocus\r\n                    margin=\"dense\"\r\n                    id=\"profileName\"\r\n                    label=\"Profile Name\"\r\n                    fullWidth\r\n                    {...bindName}\r\n                />\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={handleConfirm} color=\"primary\">\r\n                    Confirm\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>);\r\n}\r\n\r\nfunction RewardTable(rewards, setRewards, headers) {\r\n    const {value: raddN, bind: bindRaddN, reset: resetRaddN} = useInput('');\r\n    const {value: raddP, bind: bindRaddP, reset: resetRaddP} = useInput('');\r\n    const {value: raddV, bind: bindRaddV, reset: resetRaddV} = useInput('');\r\n    const addReward = (e) => {\r\n        e.preventDefault();\r\n        setRewards({...rewards, [raddN]: [Number(raddP), Number(raddV), true]});\r\n        resetRaddN();\r\n        resetRaddP();\r\n        resetRaddV();\r\n    };\r\n    const handleSwitch = (e) => {\r\n        const name = e.target.name;\r\n        let val = [...rewards[name]];\r\n        val[2] = e.target.checked;\r\n        setRewards({...rewards, [name]: val});\r\n    };\r\n    const removeReward = (name) => {\r\n        let newVal = {...rewards};\r\n        delete newVal[name];\r\n        setRewards(newVal);\r\n    };\r\n    let rewardList = [];\r\n    for (let name in rewards) {\r\n        if (!rewards.hasOwnProperty(name))\r\n            continue;\r\n        rewardList.push(\r\n            <TableRow key={name}>\r\n                <TableCell padding=\"none\">\r\n                    <Switch color=\"primary\" checked={rewards[name][2]} name={name} onChange={handleSwitch}/>\r\n                </TableCell>\r\n                <TableCell padding=\"none\">{name}</TableCell>\r\n                <TableCell padding=\"none\">{rewards[name][0]}</TableCell>\r\n                <TableCell padding=\"none\">{rewards[name][1]}</TableCell>\r\n                <TableCell>\r\n                    <Button variant=\"outlined\" color=\"secondary\" onClick={e => removeReward(name)}>Del</Button>\r\n                </TableCell>\r\n            </TableRow>\r\n        );\r\n    }\r\n    return (\r\n        <TableContainer component={Paper}>\r\n            <Table aria-label=\"simple table\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        <TableCell padding=\"none\">\r\n                            <Switch disabled/>\r\n                        </TableCell>\r\n                        {headers.map(h => (<TableCell padding=\"none\" key={h}>{h}</TableCell>))}\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {rewardList}\r\n                    <TableRow>\r\n                        <TableCell padding=\"none\"/>\r\n                        <TableCell padding=\"none\" size=\"small\"><TextField fullWidth label=\"Name\" variant=\"outlined\"\r\n                                                                          size=\"small\"\r\n                                                                          required {...bindRaddN}/></TableCell>\r\n                        <TableCell padding=\"none\" size=\"small\"><TextField fullWidth label=\"Prob\" variant=\"outlined\"\r\n                                                                          size=\"small\"\r\n                                                                          required {...bindRaddP}/></TableCell>\r\n                        <TableCell padding=\"none\" size=\"small\"><TextField fullWidth label=\"Value\" variant=\"outlined\"\r\n                                                                          size=\"small\"\r\n                                                                          required {...bindRaddV}/></TableCell>\r\n                        <TableCell size=\"small\"><Button variant=\"contained\" color=\"primary\"\r\n                                                        onClick={addReward}>Add</Button></TableCell>\r\n                    </TableRow>\r\n                </TableBody>\r\n            </Table>\r\n        </TableContainer>\r\n    )\r\n}\r\n\r\nfunction ProfileSelect(rewards, setRewards) {\r\n    const defaultProfiles = {\r\n        \"Limited-3\": {\r\n            'Focus-1': [0.004, 30, true],\r\n            'Focus-2': [0.004, 20, true],\r\n            'Focus-3': [0.004, 10, true],\r\n            'Perm': [0.018, 2, true]\r\n        },\r\n        \"Limited-2\": {\r\n            'Focus-1': [0.004, 30, true],\r\n            'Focus-2': [0.004, 10, true],\r\n            'Perm': [0.022, 2, true]\r\n        },\r\n        \"Limited-1\": {\r\n            'Focus-1': [0.0075, 30, true],\r\n            'Perm': [0.0225, 2, true]\r\n        },\r\n        \"Cinfes-2\": {\r\n            'Focus-1': [0.005, 20, true],\r\n            'Focus-2': [0.005, 15, true],\r\n            'Fes-Type': [0.00375, 15, true],\r\n            'Fes-Other': [0.00375, 15, true],\r\n            'Perm': [0.0425, 2, true],\r\n            'Fes-Spark': [0, 30, true]\r\n        },\r\n        \"Cinfes-1\": {\r\n            'Focus-1': [0.0075, 20, true],\r\n            'Fes-Type': [0.00375, 15, true],\r\n            'Fes-Other': [0.00375, 15, true],\r\n            'Perm': [0.045, 2, true],\r\n            'Fes-Spark': [0, 30, true]\r\n        },\r\n        \"Empty\": {}\r\n    };\r\n    let localProfiles = localStorage.getItem(\"profiles\");\r\n    if (localProfiles === null) {\r\n        localProfiles = defaultProfiles;\r\n        localStorage.setItem(\"profiles\", JSON.stringify(localProfiles));\r\n    } else {\r\n        localProfiles = JSON.parse(localProfiles);\r\n    }\r\n    const [profiles, setProfiles] = useState(localProfiles);\r\n    let defaultSelected = \"\";\r\n    for (let pname in profiles) {\r\n        if (!profiles.hasOwnProperty(pname)) continue;\r\n        defaultSelected = pname;\r\n        break;\r\n    }\r\n\r\n    const [open, setOpen] = React.useState(false);\r\n    const {value: profileName, bind: bindProfileName, reset: resetProfileName} = useInput(\"\");\r\n\r\n    const {value: profile, bind: bindProfile} = useInput(defaultSelected);\r\n    const handleLoad = (e) => {\r\n        e.preventDefault();\r\n        if (profile === \"\" || !profiles.hasOwnProperty(profile)) return;\r\n        setRewards(profiles[profile]);\r\n    };\r\n    const handleDelete = (e) => {\r\n        e.preventDefault();\r\n        if (profile === \"\" || !profiles.hasOwnProperty(profile)) return;\r\n        const newProfiles = {...profiles};\r\n        delete newProfiles[profile];\r\n        resetProfileName();\r\n        localStorage.setItem(\"profiles\", JSON.stringify(newProfiles));\r\n        setProfiles(newProfiles);\r\n    };\r\n    const handleSave = (e) => {\r\n        e.preventDefault();\r\n        setOpen(true);\r\n    };\r\n\r\n    const handleConfirm = (e) => {\r\n        e.preventDefault();\r\n        const newProfiles = {...profiles, [profileName]: {...rewards}};\r\n        localStorage.setItem(\"profiles\", JSON.stringify(newProfiles));\r\n        setOpen(false);\r\n        setProfiles(newProfiles);\r\n    };\r\n    const handleCancel = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    let profileList = [];\r\n    for (let name in profiles) {\r\n        if (!profiles.hasOwnProperty(name))\r\n            continue;\r\n        profileList.push(\r\n            <MenuItem key={name} value={name}>{name}</MenuItem>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Grid container spacing={1}>\r\n                <Grid item xs={12}>\r\n                    <TextField select fullWidth label=\"Select Profile\" {...bindProfile} xs={6}>\r\n                        {profileList}\r\n                    </TextField>\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                    <Button variant=\"contained\" fullWidth onClick={handleLoad}>Load</Button>\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                    <Button margin=\"normal\" variant=\"contained\" fullWidth color=\"secondary\"\r\n                            onClick={handleDelete}>Delete</Button>\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                    <Button margin=\"normal\" variant=\"contained\" fullWidth color=\"primary\"\r\n                            onClick={handleSave}>Save</Button>\r\n                </Grid>\r\n            </Grid>\r\n            {\r\n                NameInputDialog(\"Enter the name for current gacha profile to save(override if exists):\",\r\n                    \"Save Profile\",\r\n                    open,\r\n                    handleCancel,\r\n                    handleConfirm,\r\n                    bindProfileName)\r\n            }\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction RefValueTable(pulls, rewards) {\r\n    let defaultRefValues = localStorage.getItem(\"refValues\");\r\n    if (defaultRefValues === null) {\r\n        defaultRefValues = [];\r\n        localStorage.setItem(\"refValues\", JSON.stringify([]));\r\n    } else {\r\n        defaultRefValues = JSON.parse(defaultRefValues);\r\n    }\r\n    const [refValues, setRefValues] = useState(defaultRefValues);\r\n\r\n    const removeRefValue = (name) => {\r\n        let newVal = refValues.filter(x => x[0] !== name);\r\n        localStorage.setItem(\"refValues\", JSON.stringify(newVal));\r\n        setRefValues(newVal);\r\n    };\r\n\r\n    const [open, setOpen] = React.useState(false);\r\n    const {value: refValueName, bind: bindRefValueName} = useInput(\"\");\r\n    const [selectedRefValue, setSelectedRefValue] = useState([]);\r\n    const handleAdd = (refValue) => {\r\n        setSelectedRefValue(refValue);\r\n        setOpen(true);\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const addRefValue = () => {\r\n        let newVal = refValues.filter(x => x[0] !== refValueName);\r\n        newVal.push([refValueName, selectedRefValue[1]]);\r\n        localStorage.setItem(\"refValues\", JSON.stringify(newVal));\r\n        setRefValues(newVal);\r\n        setOpen(false);\r\n    };\r\n\r\n    let pullsToSpark = 300 - pulls;\r\n    let valueSpark = (calc_gacha_value(pullsToSpark, rewards) + calc_spark_value(pullsToSpark, rewards)) / pullsToSpark;\r\n    let value10 = calc_gacha_value(10, rewards) / 10;\r\n    let refValueRows = [];\r\n    for (let rv of [...refValues, [\"10 Pulls\", value10, true], [pullsToSpark + \" Pulls\", valueSpark, true]].sort((a, b) => b[1] - a[1])) {\r\n        refValueRows.push(\r\n            <TableRow key={rv[0]}>\r\n                <TableCell style={rv[2] ? {background: \"LightGreen\"} : {background: \"white\"}}>{rv[0]}</TableCell>\r\n                <TableCell>{Math.round(rv[1] * 100000) / 100000}</TableCell>\r\n                <TableCell>\r\n                    {\r\n                        rv[2]\r\n                            ? <Button variant=\"outlined\" color=\"primary\" onClick={e => handleAdd(rv)}>Pin</Button>\r\n                            : <Button variant=\"outlined\" color=\"secondary\"\r\n                                      onClick={e => removeRefValue(rv[0])}>Del</Button>\r\n                    }\r\n                </TableCell>\r\n            </TableRow>\r\n        );\r\n    }\r\n    return (\r\n        <TableContainer component={Paper}>\r\n            <Table aria-label=\"simple table\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        <TableCell>Ref Name</TableCell>\r\n                        <TableCell>Value per pull</TableCell>\r\n                        <TableCell>Action</TableCell>\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {refValueRows}\r\n                </TableBody>\r\n            </Table>\r\n            {\r\n                NameInputDialog(\"Save current ref value as:\",\r\n                    \"Save Ref Value\",\r\n                    open,\r\n                    handleCancel,\r\n                    addRefValue,\r\n                    bindRefValueName)\r\n            }\r\n        </TableContainer>\r\n    );\r\n}\r\n\r\nexport function GachaToolPage() {\r\n    const [rewards, setRewards] = useState({});\r\n    const {value: pulls, bind: bindPulls} = useInput(0);\r\n    const spark_value = calc_spark_value(300 - pulls, rewards);\r\n    return (\r\n        <PageFrame title=\"Gacha Tool\">\r\n            <Grid container spacing={3}>\r\n                <Grid container item xs={12} md={4} lg={3}>\r\n                    <Paper>\r\n                        <TextField autoFocus margin=\"normal\" label=\"Pulls Done\" variant=\"outlined\"\r\n                                   required {...bindPulls}/>\r\n                        {\r\n                            ProfileSelect(rewards, setRewards)\r\n                        }\r\n                        <Typography variant=\"subtitle1\">Estimated spark value: {spark_value}</Typography>\r\n                    </Paper>\r\n                </Grid>\r\n                <Grid item xs={12} md={8} lg={9}>\r\n                    <Paper>\r\n                        {\r\n                            RefValueTable(pulls, rewards)\r\n                        }\r\n                    </Paper>\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <Paper>\r\n                        {\r\n                            RewardTable(rewards, setRewards, ['Reward', 'Prob', 'Value', 'Action'])\r\n                        }\r\n                    </Paper>\r\n                </Grid>\r\n            </Grid>\r\n        </PageFrame>\r\n    );\r\n}","import Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport React from \"react\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport {Link as RouterLink} from \"react-router-dom\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Divider from '@material-ui/core/Divider';\r\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\r\nimport StarIcon from \"@material-ui/icons/Star\";\r\nimport PageFrame from \"./PageFrame\";\r\nimport CollectionsIcon from \"@material-ui/icons/Collections\";\r\n\r\nexport function HomePage() {\r\n    return (\r\n        <PageFrame title=\"Glorious Dawn's Home\">\r\n            <Grid container spacing={3}>\r\n                <Grid item xs={12} md={8} lg={9}>\r\n                    <Paper>\r\n                        <List>\r\n                            <ListItem component=\"h2\" variant=\"h6\" color=\"inherit\" noWrap>\r\n                                Available tools:\r\n                            </ListItem>\r\n                            <Divider/>\r\n                            <ListItem component={RouterLink} to=\"/gacha\">\r\n                                <ListItemIcon>\r\n                                    <StarIcon/>\r\n                                </ListItemIcon>\r\n                                <ListItemText primary=\"Gacha\"/>\r\n                            </ListItem>\r\n                            <ListItem component={RouterLink} to=\"/collection\">\r\n                                <ListItemIcon>\r\n                                    <CollectionsIcon />\r\n                                </ListItemIcon>\r\n                                <ListItemText primary=\"Collection\" />\r\n                            </ListItem>\r\n                        </List>\r\n                    </Paper>\r\n                </Grid>\r\n                <Grid item xs={12} md={4} lg={3}>\r\n                    <Paper>\r\n                    </Paper>\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <Paper>\r\n                    </Paper>\r\n                </Grid>\r\n            </Grid>\r\n        </PageFrame>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableContainer from \"@material-ui/core/TableContainer\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\n\r\n\r\nexport default function MatchedTable(props) {\r\n    const {headers,items}=props;\r\n    return (\r\n        <TableContainer component={Paper}>\r\n            <Table aria-label=\"simple table\">\r\n                <TableHead>\r\n                    <TableRow key={'headers'}>\r\n                        {headers.map(x => (<TableCell key={`headers-${x}`} >{x}</TableCell>))}\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {items.map(item =>\r\n                        <TableRow key={item[0]}>\r\n                            {item.map((x,i) => (<TableCell key={`${item[0]}-${headers[i]}`} >{x}</TableCell>))}\r\n                        </TableRow>)\r\n                    }\r\n                </TableBody>\r\n            </Table>\r\n        </TableContainer>\r\n    );\r\n}","export default {\r\n    setRandomWindowOffsets:'$setRandomWindowOffsets',\r\n    setMainImageFeatures:'$setMainImageFeatures',\r\n    matchSubImageData:'$matchSubImageData',\r\n    matchSubImageFeatures:'$matchSubImageFeatures',\r\n    //TODO: optimize performance by batch processing to reduce messages, MatchWorker done.\r\n    matchSubImageFeaturesBatch:'$matchSubImageFeaturesBatch'\r\n};","import PageFrame from \"./PageFrame\";\r\nimport React, {useEffect, useRef, useState} from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Link from \"@material-ui/core/Link\"\r\nimport GeneralTable from \"./component/GeneralTable\";\r\n\r\n// eslint-disable-next-line import/no-webpack-loader-syntax\r\nimport MatchWorker from 'worker-loader!./cv/MatchWorker'\r\nimport {useMutableSortedRows} from \"./hook/MutableSortedRows\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nimport tracking from './cv/tracking';\r\nimport Strings from './Strings'\r\nimport {DropzoneArea} from \"material-ui-dropzone\";\r\n\r\nfunction handleDropFile(file, callBack) {\r\n    if (file.type.match(/image.*/)) {\r\n        //call-back hell\r\n        const reader = new FileReader();\r\n        reader.onload = e => {\r\n            let image = new Image();\r\n            image.onload = () => {\r\n                callBack(image);\r\n            };\r\n            image.id = file.name.split('.')[0];\r\n            image.src = e.target.result;\r\n        };\r\n        reader.readAsDataURL(file);\r\n    }else if (file.type.match(\"application/json\")) {\r\n        const reader = new FileReader();\r\n        reader.onload = e => {\r\n            const data=JSON.parse(e.target.result);\r\n            //console.log(JSON.parse(e.target.result));\r\n            callBack(data);\r\n        };\r\n        reader.readAsText(file);\r\n    }\r\n}\r\n\r\nfunction loadImageDataOnCanvas(image, canvas, x = 0, y = 0) {\r\n    const context = canvas.getContext('2d');\r\n    let width = image.width;\r\n    let height = image.height;\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    context.drawImage(image, x, y, width, height);\r\n    return context.getImageData(x, y, width, height);\r\n}\r\n\r\nfunction drawPoints(canvasContext, points) {\r\n    for (var i = 0; i < points.length; i++) {\r\n        var color = '#FF0000';// + Math.floor(Math.random()*16777215).toString(16);\r\n        const context = canvasContext;\r\n        context.fillStyle = color;\r\n        context.strokeStyle = color;\r\n        context.fillRect(points[i][0], points[i][1], 20, 20);\r\n    }\r\n}\r\n\r\nexport function CollectionToolPage() {\r\n    const numWorkers=8;\r\n    const {rows: matchedItems, upsert: upsertMatchedItems, remove: removeMatchedItems} =\r\n        useMutableSortedRows([], (a, b) => b[1] - a[1]);\r\n    const mainCanvasRef = useRef(null);\r\n    const subCanvasRef = useRef(null);\r\n    const workersRef = useRef([]);\r\n    const nextWorkerRef = useRef(0);\r\n    const savedNamesRef = useRef([]);\r\n    const subFeaturesRef = useRef({});\r\n    const [saved,setSaved] = useState(\"\");\r\n    // create workers\r\n    useEffect(() => {\r\n        //Fixed RandomWindowOffsets for once and for all\r\n        // const windowOffsets=Array.from(tracking.Brief.generateRandomWindowOffsets());\r\n        // tracking.Brief.setRandomWindowOffsets(windowOffsets);\r\n        for (let i = 0; i < numWorkers; i++) {\r\n            let worker = new MatchWorker();\r\n            worker.onmessage = function (event) {\r\n                if (event.data[0]===Strings.matchSubImageData || event.data[0]===Strings.matchSubImageFeatures){\r\n                    //Add to table\r\n                    const id=event.data[1];\r\n                    const matches=event.data[2];\r\n                    const subFeatures=event.data[3];\r\n                    // subFeaturesRef.current[id]=Array.from(subFeatures);\r\n                    const item=[id,matches.length];\r\n                    item.push(\r\n                        <div>\r\n                            <Button variant=\"contained\" color=\"primary\"\r\n                                    onClick={e => drawPoints(mainCanvasRef.current.getContext('2d'),matches)}>Draw</Button>\r\n                            <Button variant=\"contained\" color=\"secondary\"\r\n                                    onClick={e => {\r\n                                        savedNamesRef.current.push(id);\r\n                                        removeMatchedItems(item);\r\n                                    }}>Add</Button>\r\n                        </div>\r\n                    );\r\n                    upsertMatchedItems(item);\r\n                }else{\r\n                    console.log(event.data[0]);\r\n                }\r\n            };\r\n            // worker.postMessage([Strings.setRandomWindowOffsets,windowOffsets]);\r\n            workersRef.current.push(worker);\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n        return ()=>{for (let worker of workersRef.current) worker.terminate();};}, []);\r\n\r\n    const subDropCallback = function (result) {\r\n        if (result instanceof Image) {\r\n            const subImageData = loadImageDataOnCanvas(result, subCanvasRef.current);\r\n            workersRef.current[nextWorkerRef.current].postMessage([Strings.matchSubImageData, result.id, subImageData]);\r\n            nextWorkerRef.current = (nextWorkerRef.current + 1) % numWorkers;\r\n        }else{\r\n            for (let name in result){\r\n                if (!result.hasOwnProperty(name)) continue;\r\n                workersRef.current[nextWorkerRef.current].postMessage([Strings.matchSubImageFeatures, name, result[name]]);\r\n                nextWorkerRef.current = (nextWorkerRef.current + 1) % numWorkers;\r\n            }\r\n        }\r\n    };\r\n\r\n    const mainDropCallback = function (image) {\r\n        if (image instanceof Image){\r\n            const imageData = loadImageDataOnCanvas(image, mainCanvasRef.current);\r\n            //Distribute main image features to all workers\r\n            const grayscale = tracking.Image.grayscale(imageData.data, imageData.width, imageData.height);\r\n            const corners = tracking.Fast.findCorners(grayscale, imageData.width, imageData.height);\r\n            const descriptors = tracking.Brief.getDescriptors(grayscale, imageData.width, corners);\r\n            for (let worker of workersRef.current){\r\n                worker.postMessage([Strings.setMainImageFeatures,corners,descriptors]);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleExport = function(e){\r\n        // const matchResult={};\r\n        // for (const x of matchedItems){\r\n        //     matchResult[x[0]]=x[1];\r\n        // }\r\n        // console.log(JSON.stringify(matchResult));\r\n        // console.log(JSON.stringify(subFeaturesRef.current));\r\n        setSaved(savedNamesRef.current.join(' '));\r\n    };\r\n\r\n    return (\r\n        <PageFrame title=\"Collection Tool\">\r\n            <Grid container spacing={3}>\r\n                <Grid item xs={6}>\r\n                    <DropzoneArea dropzoneText=\"Drop or Click: Main image\" filesLimit={2} maxFileSize={Infinity}\r\n                                  showPreviewsInDropzone={false} showAlerts={false}\r\n                                  onDrop={file => handleDropFile(file, mainDropCallback)}/>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                    <DropzoneArea dropzoneText=\"Drop or Click: Sub images or Features JSON\" filesLimit={1024} maxFileSize={Infinity}\r\n                                  showPreviewsInDropzone={false} showAlerts={false}\r\n                                  onDrop={file => handleDropFile(file, subDropCallback)}/>\r\n                    <Link href=\"/data/ssr+040320.json\" download>Download SSR+040320.json</Link>\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    {/*<Paper onDragOver={e => e.preventDefault()} onDrop={e => handleDropImages(e, subDropCallback)}/>*/}\r\n                    <canvas ref={mainCanvasRef} width={0} height={0}/>\r\n                    <canvas ref={subCanvasRef} hidden/>\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <Button size=\"large\" variant=\"contained\" color=\"primary\" onClick={handleExport}>Export</Button>\r\n                    <TextField variant=\"filled\" value={saved} disabled={true}/>\r\n                    <GeneralTable headers={['Name','Matches','Actions']} items={matchedItems}/>\r\n                </Grid>\r\n            </Grid>\r\n            {/*style={{height:'100%'}}*/}\r\n        </PageFrame>\r\n    );\r\n}\r\n","import {useState,useRef} from \"react\";\r\n\r\nexport const useMutableSortedRows = (initialValue,compareFn=(a,b)=>a[0]-b[0]) => {\r\n    //rowsRef is unchanged across setRows.\r\n    const rowsRef=useRef(initialValue);\r\n    const [rows, setRows] = useState(initialValue);\r\n    // can't get rid of rowsRef and use rows directly because of the caller...\r\n    // The caller worker.onmessage is only initialized once in useEffect,\r\n    // meaning its address to upsert is fixed, while the address will change after setRows.\r\n    // resulting in upserting to a stale rows state and have no effect.\r\n    const upsert = x => {\r\n        let newRows=rowsRef.current;\r\n        let p=newRows.findIndex(y=>y[0]===x[0]);\r\n        if (p!==-1)\r\n            newRows.splice(p,1);\r\n        for (p=0; p<newRows.length; ++p){\r\n            if (compareFn(x,newRows[p])<=0)\r\n                break;\r\n        }\r\n        newRows.splice(p,0,x);\r\n        // Have to copy to trigger the update\r\n        setRows([...newRows]);\r\n    };\r\n\r\n    const remove = x => {\r\n        let newRows=rowsRef.current;\r\n        let p=newRows.findIndex(y=>y[0]===x[0]);\r\n        if (p!==-1)\r\n            newRows.splice(p,1);\r\n        setRows([...newRows]);\r\n    };\r\n\r\n    return {\r\n        rows,\r\n        upsert,\r\n        remove\r\n    }\r\n};","import React from 'react';\r\n\r\nimport {\r\n    HashRouter as Router,\r\n    Switch,\r\n    Route\r\n} from \"react-router-dom\";\r\n\r\nimport {GachaToolPage} from \"./GachaToolPage\";\r\nimport {HomePage} from \"./HomePage\";\r\nimport {CollectionToolPage} from \"./CollectionToolPage\";\r\n\r\nexport default function App() {\r\n    return (\r\n        <Router>\r\n            <Switch>\r\n                <Route path=\"/collection\">\r\n                    <CollectionToolPage/>\r\n                </Route>\r\n                <Route path=\"/gacha\">\r\n                    <GachaToolPage/>\r\n                </Route>\r\n                <Route path='/' exact>\r\n                    <HomePage/>\r\n                </Route>\r\n            </Switch>\r\n        </Router>\r\n    );\r\n}","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.register();\r\n","/* eslint-disable */\r\n/**\r\n * tracking - A modern approach for Computer Vision on the web.\r\n * @author Eduardo Lundgren <edu@rdo.io>\r\n * @version v1.1.2\r\n * @link http://trackingjs.com\r\n * @license BSD\r\n */\r\nlet tracking={};\r\n\r\n(function() {\r\n  /**\r\n   * EventEmitter utility.\r\n   * @constructor\r\n   */\r\n  tracking.EventEmitter = function() {};\r\n\r\n  /**\r\n   * Holds event listeners scoped by event type.\r\n   * @type {object}\r\n   * @private\r\n   */\r\n  tracking.EventEmitter.prototype.events_ = null;\r\n\r\n  /**\r\n   * Adds a listener to the end of the listeners array for the specified event.\r\n   * @param {string} event\r\n   * @param {function} listener\r\n   * @return {object} Returns emitter, so calls can be chained.\r\n   */\r\n  tracking.EventEmitter.prototype.addListener = function(event, listener) {\r\n    if (typeof listener !== 'function') {\r\n      throw new TypeError('Listener must be a function');\r\n    }\r\n    if (!this.events_) {\r\n      this.events_ = {};\r\n    }\r\n\r\n    this.emit('newListener', event, listener);\r\n\r\n    if (!this.events_[event]) {\r\n      this.events_[event] = [];\r\n    }\r\n\r\n    this.events_[event].push(listener);\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Returns an array of listeners for the specified event.\r\n   * @param {string} event\r\n   * @return {array} Array of listeners.\r\n   */\r\n  tracking.EventEmitter.prototype.listeners = function(event) {\r\n    return this.events_ && this.events_[event];\r\n  };\r\n\r\n  /**\r\n   * Execute each of the listeners in order with the supplied arguments.\r\n   * @param {string} event\r\n   * @param {*} opt_args [arg1], [arg2], [...]\r\n   * @return {boolean} Returns true if event had listeners, false otherwise.\r\n   */\r\n  tracking.EventEmitter.prototype.emit = function(event) {\r\n    var listeners = this.listeners(event);\r\n    if (listeners) {\r\n      var args = Array.prototype.slice.call(arguments, 1);\r\n      for (var i = 0; i < listeners.length; i++) {\r\n        if (listeners[i]) {\r\n          listeners[i].apply(this, args);\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  /**\r\n   * Adds a listener to the end of the listeners array for the specified event.\r\n   * @param {string} event\r\n   * @param {function} listener\r\n   * @return {object} Returns emitter, so calls can be chained.\r\n   */\r\n  tracking.EventEmitter.prototype.on = tracking.EventEmitter.prototype.addListener;\r\n\r\n  /**\r\n   * Adds a one time listener for the event. This listener is invoked only the\r\n   * next time the event is fired, after which it is removed.\r\n   * @param {string} event\r\n   * @param {function} listener\r\n   * @return {object} Returns emitter, so calls can be chained.\r\n   */\r\n  tracking.EventEmitter.prototype.once = function(event, listener) {\r\n    var self = this;\r\n    self.on(event, function handlerInternal() {\r\n      self.removeListener(event, handlerInternal);\r\n      listener.apply(this, arguments);\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Removes all listeners, or those of the specified event. It's not a good\r\n   * idea to remove listeners that were added elsewhere in the code,\r\n   * especially when it's on an emitter that you didn't create.\r\n   * @param {string} event\r\n   * @return {object} Returns emitter, so calls can be chained.\r\n   */\r\n  tracking.EventEmitter.prototype.removeAllListeners = function(opt_event) {\r\n    if (!this.events_) {\r\n      return this;\r\n    }\r\n    if (opt_event) {\r\n      delete this.events_[opt_event];\r\n    } else {\r\n      delete this.events_;\r\n    }\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Remove a listener from the listener array for the specified event.\r\n   * Caution: changes array indices in the listener array behind the listener.\r\n   * @param {string} event\r\n   * @param {function} listener\r\n   * @return {object} Returns emitter, so calls can be chained.\r\n   */\r\n  tracking.EventEmitter.prototype.removeListener = function(event, listener) {\r\n    if (typeof listener !== 'function') {\r\n      throw new TypeError('Listener must be a function');\r\n    }\r\n    if (!this.events_) {\r\n      return this;\r\n    }\r\n\r\n    var listeners = this.listeners(event);\r\n    if (Array.isArray(listeners)) {\r\n      var i = listeners.indexOf(listener);\r\n      if (i < 0) {\r\n        return this;\r\n      }\r\n      listeners.splice(i, 1);\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * By default EventEmitters will print a warning if more than 10 listeners\r\n   * are added for a particular event. This is a useful default which helps\r\n   * finding memory leaks. Obviously not all Emitters should be limited to 10.\r\n   * This function allows that to be increased. Set to zero for unlimited.\r\n   * @param {number} n The maximum number of listeners.\r\n   */\r\n  tracking.EventEmitter.prototype.setMaxListeners = function() {\r\n    throw new Error('Not implemented');\r\n  };\r\n\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * Canvas utility.\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.Canvas = {};\r\n\r\n  /**\r\n   * Loads an image source into the canvas.\r\n   * @param {HTMLCanvasElement} canvas The canvas dom element.\r\n   * @param {string} src The image source.\r\n   * @param {number} x The canvas horizontal coordinate to load the image.\r\n   * @param {number} y The canvas vertical coordinate to load the image.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {function} opt_callback Callback that fires when the image is loaded\r\n   *     into the canvas.\r\n   * @static\r\n   */\r\n  tracking.Canvas.loadImage = function(canvas, src, x, y, width, height, opt_callback) {\r\n    var instance = this;\r\n    var img = new window.Image();\r\n    img.crossOrigin = '*';\r\n    img.onload = function() {\r\n      var context = canvas.getContext('2d');\r\n      canvas.width = width;\r\n      canvas.height = height;\r\n      context.drawImage(img, x, y, width, height);\r\n      if (opt_callback) {\r\n        opt_callback.call(instance);\r\n      }\r\n      img = null;\r\n    };\r\n    img.src = src;\r\n  };\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * DisjointSet utility with path compression. Some applications involve\r\n   * grouping n distinct objects into a collection of disjoint sets. Two\r\n   * important operations are then finding which set a given object belongs to\r\n   * and uniting the two sets. A disjoint set data structure maintains a\r\n   * collection S={ S1 , S2 ,..., Sk } of disjoint dynamic sets. Each set is\r\n   * identified by a representative, which usually is a member in the set.\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.DisjointSet = function(length) {\r\n    if (length === undefined) {\r\n      throw new Error('DisjointSet length not specified.');\r\n    }\r\n    this.length = length;\r\n    this.parent = new Uint32Array(length);\r\n    for (var i = 0; i < length; i++) {\r\n      this.parent[i] = i;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Holds the length of the internal set.\r\n   * @type {number}\r\n   */\r\n  tracking.DisjointSet.prototype.length = null;\r\n\r\n  /**\r\n   * Holds the set containing the representative values.\r\n   * @type {Array.<number>}\r\n   */\r\n  tracking.DisjointSet.prototype.parent = null;\r\n\r\n  /**\r\n   * Finds a pointer to the representative of the set containing i.\r\n   * @param {number} i\r\n   * @return {number} The representative set of i.\r\n   */\r\n  tracking.DisjointSet.prototype.find = function(i) {\r\n    if (this.parent[i] === i) {\r\n      return i;\r\n    } else {\r\n      return (this.parent[i] = this.find(this.parent[i]));\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Unites two dynamic sets containing objects i and j, say Si and Sj, into\r\n   * a new set that Si  Sj, assuming that Si  Sj = ;\r\n   * @param {number} i\r\n   * @param {number} j\r\n   */\r\n  tracking.DisjointSet.prototype.union = function(i, j) {\r\n    var iRepresentative = this.find(i);\r\n    var jRepresentative = this.find(j);\r\n    this.parent[iRepresentative] = jRepresentative;\r\n  };\r\n\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * Image utility.\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.Image = {};\r\n\r\n  /**\r\n   * Computes gaussian blur. Adapted from\r\n   * https://github.com/kig/canvasfilters.\r\n   * @param {pixels} pixels The pixels in a linear [r,g,b,a,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {number} diameter Gaussian blur diameter, must be greater than 1.\r\n   * @return {array} The edge pixels in a linear [r,g,b,a,...] array.\r\n   */\r\n  tracking.Image.blur = function(pixels, width, height, diameter) {\r\n    diameter = Math.abs(diameter);\r\n    if (diameter <= 1) {\r\n      throw new Error('Diameter should be greater than 1.');\r\n    }\r\n    var radius = diameter / 2;\r\n    var len = Math.ceil(diameter) + (1 - (Math.ceil(diameter) % 2));\r\n    var weights = new Float32Array(len);\r\n    var rho = (radius + 0.5) / 3;\r\n    var rhoSq = rho * rho;\r\n    var gaussianFactor = 1 / Math.sqrt(2 * Math.PI * rhoSq);\r\n    var rhoFactor = -1 / (2 * rho * rho);\r\n    var wsum = 0;\r\n    var middle = Math.floor(len / 2);\r\n    for (var i = 0; i < len; i++) {\r\n      var x = i - middle;\r\n      var gx = gaussianFactor * Math.exp(x * x * rhoFactor);\r\n      weights[i] = gx;\r\n      wsum += gx;\r\n    }\r\n    for (var j = 0; j < weights.length; j++) {\r\n      weights[j] /= wsum;\r\n    }\r\n    return this.separableConvolve(pixels, width, height, weights, weights, false);\r\n  };\r\n\r\n  /**\r\n   * Computes the integral image for summed, squared, rotated and sobel pixels.\r\n   * @param {array} pixels The pixels in a linear [r,g,b,a,...] array to loop\r\n   *     through.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {array} opt_integralImage Empty array of size `width * height` to\r\n   *     be filled with the integral image values. If not specified compute sum\r\n   *     values will be skipped.\r\n   * @param {array} opt_integralImageSquare Empty array of size `width *\r\n   *     height` to be filled with the integral image squared values. If not\r\n   *     specified compute squared values will be skipped.\r\n   * @param {array} opt_tiltedIntegralImage Empty array of size `width *\r\n   *     height` to be filled with the rotated integral image values. If not\r\n   *     specified compute sum values will be skipped.\r\n   * @param {array} opt_integralImageSobel Empty array of size `width *\r\n   *     height` to be filled with the integral image of sobel values. If not\r\n   *     specified compute sobel filtering will be skipped.\r\n   * @static\r\n   */\r\n  tracking.Image.computeIntegralImage = function(pixels, width, height, opt_integralImage, opt_integralImageSquare, opt_tiltedIntegralImage, opt_integralImageSobel) {\r\n    if (arguments.length < 4) {\r\n      throw new Error('You should specify at least one output array in the order: sum, square, tilted, sobel.');\r\n    }\r\n    var pixelsSobel;\r\n    if (opt_integralImageSobel) {\r\n      pixelsSobel = tracking.Image.sobel(pixels, width, height);\r\n    }\r\n    for (var i = 0; i < height; i++) {\r\n      for (var j = 0; j < width; j++) {\r\n        var w = i * width * 4 + j * 4;\r\n        var pixel = ~~(pixels[w] * 0.299 + pixels[w + 1] * 0.587 + pixels[w + 2] * 0.114);\r\n        if (opt_integralImage) {\r\n          this.computePixelValueSAT_(opt_integralImage, width, i, j, pixel);\r\n        }\r\n        if (opt_integralImageSquare) {\r\n          this.computePixelValueSAT_(opt_integralImageSquare, width, i, j, pixel * pixel);\r\n        }\r\n        if (opt_tiltedIntegralImage) {\r\n          var w1 = w - width * 4;\r\n          var pixelAbove = ~~(pixels[w1] * 0.299 + pixels[w1 + 1] * 0.587 + pixels[w1 + 2] * 0.114);\r\n          this.computePixelValueRSAT_(opt_tiltedIntegralImage, width, i, j, pixel, pixelAbove || 0);\r\n        }\r\n        if (opt_integralImageSobel) {\r\n          this.computePixelValueSAT_(opt_integralImageSobel, width, i, j, pixelsSobel[w]);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Helper method to compute the rotated summed area table (RSAT) by the\r\n   * formula:\r\n   *\r\n   * RSAT(x, y) = RSAT(x-1, y-1) + RSAT(x+1, y-1) - RSAT(x, y-2) + I(x, y) + I(x, y-1)\r\n   *\r\n   * @param {number} width The image width.\r\n   * @param {array} RSAT Empty array of size `width * height` to be filled with\r\n   *     the integral image values. If not specified compute sum values will be\r\n   *     skipped.\r\n   * @param {number} i Vertical position of the pixel to be evaluated.\r\n   * @param {number} j Horizontal position of the pixel to be evaluated.\r\n   * @param {number} pixel Pixel value to be added to the integral image.\r\n   * @static\r\n   * @private\r\n   */\r\n  tracking.Image.computePixelValueRSAT_ = function(RSAT, width, i, j, pixel, pixelAbove) {\r\n    var w = i * width + j;\r\n    RSAT[w] = (RSAT[w - width - 1] || 0) + (RSAT[w - width + 1] || 0) - (RSAT[w - width - width] || 0) + pixel + pixelAbove;\r\n  };\r\n\r\n  /**\r\n   * Helper method to compute the summed area table (SAT) by the formula:\r\n   *\r\n   * SAT(x, y) = SAT(x, y-1) + SAT(x-1, y) + I(x, y) - SAT(x-1, y-1)\r\n   *\r\n   * @param {number} width The image width.\r\n   * @param {array} SAT Empty array of size `width * height` to be filled with\r\n   *     the integral image values. If not specified compute sum values will be\r\n   *     skipped.\r\n   * @param {number} i Vertical position of the pixel to be evaluated.\r\n   * @param {number} j Horizontal position of the pixel to be evaluated.\r\n   * @param {number} pixel Pixel value to be added to the integral image.\r\n   * @static\r\n   * @private\r\n   */\r\n  tracking.Image.computePixelValueSAT_ = function(SAT, width, i, j, pixel) {\r\n    var w = i * width + j;\r\n    SAT[w] = (SAT[w - width] || 0) + (SAT[w - 1] || 0) + pixel - (SAT[w - width - 1] || 0);\r\n  };\r\n\r\n  /**\r\n   * Converts a color from a colorspace based on an RGB color model to a\r\n   * grayscale representation of its luminance. The coefficients represent the\r\n   * measured intensity perception of typical trichromat humans, in\r\n   * particular, human vision is most sensitive to green and least sensitive\r\n   * to blue.\r\n   * @param {pixels} pixels The pixels in a linear [r,g,b,a,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {boolean} fillRGBA If the result should fill all RGBA values with the gray scale\r\n   *  values, instead of returning a single value per pixel.\r\n   * @param {Uint8ClampedArray} The grayscale pixels in a linear array ([p,p,p,a,...] if fillRGBA\r\n   *  is true and [p1, p2, p3, ...] if fillRGBA is false).\r\n   * @static\r\n   */\r\n  tracking.Image.grayscale = function(pixels, width, height, fillRGBA) {\r\n    var gray = new Uint8ClampedArray(fillRGBA ? pixels.length : pixels.length >> 2);\r\n    var p = 0;\r\n    var w = 0;\r\n    for (var i = 0; i < height; i++) {\r\n      for (var j = 0; j < width; j++) {\r\n        var value = pixels[w] * 0.299 + pixels[w + 1] * 0.587 + pixels[w + 2] * 0.114;\r\n        gray[p++] = value;\r\n\r\n        if (fillRGBA) {\r\n          gray[p++] = value;\r\n          gray[p++] = value;\r\n          gray[p++] = pixels[w + 3];\r\n        }\r\n\r\n        w += 4;\r\n      }\r\n    }\r\n    return gray;\r\n  };\r\n\r\n  /**\r\n   * Fast horizontal separable convolution. A point spread function (PSF) is\r\n   * said to be separable if it can be broken into two one-dimensional\r\n   * signals: a vertical and a horizontal projection. The convolution is\r\n   * performed by sliding the kernel over the image, generally starting at the\r\n   * top left corner, so as to move the kernel through all the positions where\r\n   * the kernel fits entirely within the boundaries of the image. Adapted from\r\n   * https://github.com/kig/canvasfilters.\r\n   * @param {pixels} pixels The pixels in a linear [r,g,b,a,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {array} weightsVector The weighting vector, e.g [-1,0,1].\r\n   * @param {number} opaque\r\n   * @return {array} The convoluted pixels in a linear [r,g,b,a,...] array.\r\n   */\r\n  tracking.Image.horizontalConvolve = function(pixels, width, height, weightsVector, opaque) {\r\n    var side = weightsVector.length;\r\n    var halfSide = Math.floor(side / 2);\r\n    var output = new Float32Array(width * height * 4);\r\n    var alphaFac = opaque ? 1 : 0;\r\n\r\n    for (var y = 0; y < height; y++) {\r\n      for (var x = 0; x < width; x++) {\r\n        var sy = y;\r\n        var sx = x;\r\n        var offset = (y * width + x) * 4;\r\n        var r = 0;\r\n        var g = 0;\r\n        var b = 0;\r\n        var a = 0;\r\n        for (var cx = 0; cx < side; cx++) {\r\n          var scy = sy;\r\n          var scx = Math.min(width - 1, Math.max(0, sx + cx - halfSide));\r\n          var poffset = (scy * width + scx) * 4;\r\n          var wt = weightsVector[cx];\r\n          r += pixels[poffset] * wt;\r\n          g += pixels[poffset + 1] * wt;\r\n          b += pixels[poffset + 2] * wt;\r\n          a += pixels[poffset + 3] * wt;\r\n        }\r\n        output[offset] = r;\r\n        output[offset + 1] = g;\r\n        output[offset + 2] = b;\r\n        output[offset + 3] = a + alphaFac * (255 - a);\r\n      }\r\n    }\r\n    return output;\r\n  };\r\n\r\n  /**\r\n   * Fast vertical separable convolution. A point spread function (PSF) is\r\n   * said to be separable if it can be broken into two one-dimensional\r\n   * signals: a vertical and a horizontal projection. The convolution is\r\n   * performed by sliding the kernel over the image, generally starting at the\r\n   * top left corner, so as to move the kernel through all the positions where\r\n   * the kernel fits entirely within the boundaries of the image. Adapted from\r\n   * https://github.com/kig/canvasfilters.\r\n   * @param {pixels} pixels The pixels in a linear [r,g,b,a,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {array} weightsVector The weighting vector, e.g [-1,0,1].\r\n   * @param {number} opaque\r\n   * @return {array} The convoluted pixels in a linear [r,g,b,a,...] array.\r\n   */\r\n  tracking.Image.verticalConvolve = function(pixels, width, height, weightsVector, opaque) {\r\n    var side = weightsVector.length;\r\n    var halfSide = Math.floor(side / 2);\r\n    var output = new Float32Array(width * height * 4);\r\n    var alphaFac = opaque ? 1 : 0;\r\n\r\n    for (var y = 0; y < height; y++) {\r\n      for (var x = 0; x < width; x++) {\r\n        var sy = y;\r\n        var sx = x;\r\n        var offset = (y * width + x) * 4;\r\n        var r = 0;\r\n        var g = 0;\r\n        var b = 0;\r\n        var a = 0;\r\n        for (var cy = 0; cy < side; cy++) {\r\n          var scy = Math.min(height - 1, Math.max(0, sy + cy - halfSide));\r\n          var scx = sx;\r\n          var poffset = (scy * width + scx) * 4;\r\n          var wt = weightsVector[cy];\r\n          r += pixels[poffset] * wt;\r\n          g += pixels[poffset + 1] * wt;\r\n          b += pixels[poffset + 2] * wt;\r\n          a += pixels[poffset + 3] * wt;\r\n        }\r\n        output[offset] = r;\r\n        output[offset + 1] = g;\r\n        output[offset + 2] = b;\r\n        output[offset + 3] = a + alphaFac * (255 - a);\r\n      }\r\n    }\r\n    return output;\r\n  };\r\n\r\n  /**\r\n   * Fast separable convolution. A point spread function (PSF) is said to be\r\n   * separable if it can be broken into two one-dimensional signals: a\r\n   * vertical and a horizontal projection. The convolution is performed by\r\n   * sliding the kernel over the image, generally starting at the top left\r\n   * corner, so as to move the kernel through all the positions where the\r\n   * kernel fits entirely within the boundaries of the image. Adapted from\r\n   * https://github.com/kig/canvasfilters.\r\n   * @param {pixels} pixels The pixels in a linear [r,g,b,a,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {array} horizWeights The horizontal weighting vector, e.g [-1,0,1].\r\n   * @param {array} vertWeights The vertical vector, e.g [-1,0,1].\r\n   * @param {number} opaque\r\n   * @return {array} The convoluted pixels in a linear [r,g,b,a,...] array.\r\n   */\r\n  tracking.Image.separableConvolve = function(pixels, width, height, horizWeights, vertWeights, opaque) {\r\n    var vertical = this.verticalConvolve(pixels, width, height, vertWeights, opaque);\r\n    return this.horizontalConvolve(vertical, width, height, horizWeights, opaque);\r\n  };\r\n\r\n  /**\r\n   * Compute image edges using Sobel operator. Computes the vertical and\r\n   * horizontal gradients of the image and combines the computed images to\r\n   * find edges in the image. The way we implement the Sobel filter here is by\r\n   * first grayscaling the image, then taking the horizontal and vertical\r\n   * gradients and finally combining the gradient images to make up the final\r\n   * image. Adapted from https://github.com/kig/canvasfilters.\r\n   * @param {pixels} pixels The pixels in a linear [r,g,b,a,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @return {array} The edge pixels in a linear [r,g,b,a,...] array.\r\n   */\r\n  tracking.Image.sobel = function(pixels, width, height) {\r\n    pixels = this.grayscale(pixels, width, height, true);\r\n    var output = new Float32Array(width * height * 4);\r\n    var sobelSignVector = new Float32Array([-1, 0, 1]);\r\n    var sobelScaleVector = new Float32Array([1, 2, 1]);\r\n    var vertical = this.separableConvolve(pixels, width, height, sobelSignVector, sobelScaleVector);\r\n    var horizontal = this.separableConvolve(pixels, width, height, sobelScaleVector, sobelSignVector);\r\n\r\n    for (var i = 0; i < output.length; i += 4) {\r\n      var v = vertical[i];\r\n      var h = horizontal[i];\r\n      var p = Math.sqrt(h * h + v * v);\r\n      output[i] = p;\r\n      output[i + 1] = p;\r\n      output[i + 2] = p;\r\n      output[i + 3] = 255;\r\n    }\r\n\r\n    return output;\r\n  };\r\n\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * ViolaJones utility.\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.ViolaJones = {};\r\n\r\n  /**\r\n   * Holds the minimum area of intersection that defines when a rectangle is\r\n   * from the same group. Often when a face is matched multiple rectangles are\r\n   * classified as possible rectangles to represent the face, when they\r\n   * intersects they are grouped as one face.\r\n   * @type {number}\r\n   * @default 0.5\r\n   * @static\r\n   */\r\n  tracking.ViolaJones.REGIONS_OVERLAP = 0.5;\r\n\r\n  /**\r\n   * Holds the HAAR cascade classifiers converted from OpenCV training.\r\n   * @type {array}\r\n   * @static\r\n   */\r\n  tracking.ViolaJones.classifiers = {};\r\n\r\n  /**\r\n   * Detects through the HAAR cascade data rectangles matches.\r\n   * @param {pixels} pixels The pixels in a linear [r,g,b,a,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {number} initialScale The initial scale to start the block\r\n   *     scaling.\r\n   * @param {number} scaleFactor The scale factor to scale the feature block.\r\n   * @param {number} stepSize The block step size.\r\n   * @param {number} edgesDensity Percentage density edges inside the\r\n   *     classifier block. Value from [0.0, 1.0], defaults to 0.2. If specified\r\n   *     edge detection will be applied to the image to prune dead areas of the\r\n   *     image, this can improve significantly performance.\r\n   * @param {number} data The HAAR cascade data.\r\n   * @return {array} Found rectangles.\r\n   * @static\r\n   */\r\n  tracking.ViolaJones.detect = function(pixels, width, height, initialScale, scaleFactor, stepSize, edgesDensity, data) {\r\n    var total = 0;\r\n    var rects = [];\r\n    var integralImage = new Int32Array(width * height);\r\n    var integralImageSquare = new Int32Array(width * height);\r\n    var tiltedIntegralImage = new Int32Array(width * height);\r\n\r\n    var integralImageSobel;\r\n    if (edgesDensity > 0) {\r\n      integralImageSobel = new Int32Array(width * height);\r\n    }\r\n\r\n    tracking.Image.computeIntegralImage(pixels, width, height, integralImage, integralImageSquare, tiltedIntegralImage, integralImageSobel);\r\n\r\n    var minWidth = data[0];\r\n    var minHeight = data[1];\r\n    var scale = initialScale * scaleFactor;\r\n    var blockWidth = (scale * minWidth) | 0;\r\n    var blockHeight = (scale * minHeight) | 0;\r\n\r\n    while (blockWidth < width && blockHeight < height) {\r\n      var step = (scale * stepSize + 0.5) | 0;\r\n      for (var i = 0; i < (height - blockHeight); i += step) {\r\n        for (var j = 0; j < (width - blockWidth); j += step) {\r\n\r\n          if (edgesDensity > 0) {\r\n            if (this.isTriviallyExcluded(edgesDensity, integralImageSobel, i, j, width, blockWidth, blockHeight)) {\r\n              continue;\r\n            }\r\n          }\r\n\r\n          if (this.evalStages_(data, integralImage, integralImageSquare, tiltedIntegralImage, i, j, width, blockWidth, blockHeight, scale)) {\r\n            rects[total++] = {\r\n              width: blockWidth,\r\n              height: blockHeight,\r\n              x: j,\r\n              y: i\r\n            };\r\n          }\r\n        }\r\n      }\r\n\r\n      scale *= scaleFactor;\r\n      blockWidth = (scale * minWidth) | 0;\r\n      blockHeight = (scale * minHeight) | 0;\r\n    }\r\n    return this.mergeRectangles_(rects);\r\n  };\r\n\r\n  /**\r\n   * Fast check to test whether the edges density inside the block is greater\r\n   * than a threshold, if true it tests the stages. This can improve\r\n   * significantly performance.\r\n   * @param {number} edgesDensity Percentage density edges inside the\r\n   *     classifier block.\r\n   * @param {array} integralImageSobel The integral image of a sobel image.\r\n   * @param {number} i Vertical position of the pixel to be evaluated.\r\n   * @param {number} j Horizontal position of the pixel to be evaluated.\r\n   * @param {number} width The image width.\r\n   * @return {boolean} True whether the block at position i,j can be skipped,\r\n   *     false otherwise.\r\n   * @static\r\n   * @protected\r\n   */\r\n  tracking.ViolaJones.isTriviallyExcluded = function(edgesDensity, integralImageSobel, i, j, width, blockWidth, blockHeight) {\r\n    var wbA = i * width + j;\r\n    var wbB = wbA + blockWidth;\r\n    var wbD = wbA + blockHeight * width;\r\n    var wbC = wbD + blockWidth;\r\n    var blockEdgesDensity = (integralImageSobel[wbA] - integralImageSobel[wbB] - integralImageSobel[wbD] + integralImageSobel[wbC]) / (blockWidth * blockHeight * 255);\r\n    if (blockEdgesDensity < edgesDensity) {\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  /**\r\n   * Evaluates if the block size on i,j position is a valid HAAR cascade\r\n   * stage.\r\n   * @param {number} data The HAAR cascade data.\r\n   * @param {number} i Vertical position of the pixel to be evaluated.\r\n   * @param {number} j Horizontal position of the pixel to be evaluated.\r\n   * @param {number} width The image width.\r\n   * @param {number} blockSize The block size.\r\n   * @param {number} scale The scale factor of the block size and its original\r\n   *     size.\r\n   * @param {number} inverseArea The inverse area of the block size.\r\n   * @return {boolean} Whether the region passes all the stage tests.\r\n   * @private\r\n   * @static\r\n   */\r\n  tracking.ViolaJones.evalStages_ = function(data, integralImage, integralImageSquare, tiltedIntegralImage, i, j, width, blockWidth, blockHeight, scale) {\r\n    var inverseArea = 1.0 / (blockWidth * blockHeight);\r\n    var wbA = i * width + j;\r\n    var wbB = wbA + blockWidth;\r\n    var wbD = wbA + blockHeight * width;\r\n    var wbC = wbD + blockWidth;\r\n    var mean = (integralImage[wbA] - integralImage[wbB] - integralImage[wbD] + integralImage[wbC]) * inverseArea;\r\n    var variance = (integralImageSquare[wbA] - integralImageSquare[wbB] - integralImageSquare[wbD] + integralImageSquare[wbC]) * inverseArea - mean * mean;\r\n\r\n    var standardDeviation = 1;\r\n    if (variance > 0) {\r\n      standardDeviation = Math.sqrt(variance);\r\n    }\r\n\r\n    var length = data.length;\r\n\r\n    for (var w = 2; w < length; ) {\r\n      var stageSum = 0;\r\n      var stageThreshold = data[w++];\r\n      var nodeLength = data[w++];\r\n\r\n      while (nodeLength--) {\r\n        var rectsSum = 0;\r\n        var tilted = data[w++];\r\n        var rectsLength = data[w++];\r\n\r\n        for (var r = 0; r < rectsLength; r++) {\r\n          var rectLeft = (j + data[w++] * scale + 0.5) | 0;\r\n          var rectTop = (i + data[w++] * scale + 0.5) | 0;\r\n          var rectWidth = (data[w++] * scale + 0.5) | 0;\r\n          var rectHeight = (data[w++] * scale + 0.5) | 0;\r\n          var rectWeight = data[w++];\r\n\r\n          var w1;\r\n          var w2;\r\n          var w3;\r\n          var w4;\r\n          if (tilted) {\r\n            // RectSum(r) = RSAT(x-h+w, y+w+h-1) + RSAT(x, y-1) - RSAT(x-h, y+h-1) - RSAT(x+w, y+w-1)\r\n            w1 = (rectLeft - rectHeight + rectWidth) + (rectTop + rectWidth + rectHeight - 1) * width;\r\n            w2 = rectLeft + (rectTop - 1) * width;\r\n            w3 = (rectLeft - rectHeight) + (rectTop + rectHeight - 1) * width;\r\n            w4 = (rectLeft + rectWidth) + (rectTop + rectWidth - 1) * width;\r\n            rectsSum += (tiltedIntegralImage[w1] + tiltedIntegralImage[w2] - tiltedIntegralImage[w3] - tiltedIntegralImage[w4]) * rectWeight;\r\n          } else {\r\n            // RectSum(r) = SAT(x-1, y-1) + SAT(x+w-1, y+h-1) - SAT(x-1, y+h-1) - SAT(x+w-1, y-1)\r\n            w1 = rectTop * width + rectLeft;\r\n            w2 = w1 + rectWidth;\r\n            w3 = w1 + rectHeight * width;\r\n            w4 = w3 + rectWidth;\r\n            rectsSum += (integralImage[w1] - integralImage[w2] - integralImage[w3] + integralImage[w4]) * rectWeight;\r\n            // w1 = (rectLeft - 1) + (rectTop - 1) * width;\r\n            // w2 = (rectLeft + rectWidth - 1) + (rectTop + rectHeight - 1) * width;\r\n            // w3 = (rectLeft - 1) + (rectTop + rectHeight - 1) * width;\r\n            // w4 = (rectLeft + rectWidth - 1) + (rectTop - 1) * width;\r\n            // rectsSum += (integralImage[w1] + integralImage[w2] - integralImage[w3] - integralImage[w4]) * rectWeight;\r\n          }\r\n        }\r\n\r\n        var nodeThreshold = data[w++];\r\n        var nodeLeft = data[w++];\r\n        var nodeRight = data[w++];\r\n\r\n        if (rectsSum * inverseArea < nodeThreshold * standardDeviation) {\r\n          stageSum += nodeLeft;\r\n        } else {\r\n          stageSum += nodeRight;\r\n        }\r\n      }\r\n\r\n      if (stageSum < stageThreshold) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  };\r\n\r\n  /**\r\n   * Postprocess the detected sub-windows in order to combine overlapping\r\n   * detections into a single detection.\r\n   * @param {array} rects\r\n   * @return {array}\r\n   * @private\r\n   * @static\r\n   */\r\n  tracking.ViolaJones.mergeRectangles_ = function(rects) {\r\n    var disjointSet = new tracking.DisjointSet(rects.length);\r\n\r\n    for (var i = 0; i < rects.length; i++) {\r\n      var r1 = rects[i];\r\n      for (var j = 0; j < rects.length; j++) {\r\n        var r2 = rects[j];\r\n        if (tracking.Math.intersectRect(r1.x, r1.y, r1.x + r1.width, r1.y + r1.height, r2.x, r2.y, r2.x + r2.width, r2.y + r2.height)) {\r\n          var x1 = Math.max(r1.x, r2.x);\r\n          var y1 = Math.max(r1.y, r2.y);\r\n          var x2 = Math.min(r1.x + r1.width, r2.x + r2.width);\r\n          var y2 = Math.min(r1.y + r1.height, r2.y + r2.height);\r\n          var overlap = (x1 - x2) * (y1 - y2);\r\n          var area1 = (r1.width * r1.height);\r\n          var area2 = (r2.width * r2.height);\r\n\r\n          if ((overlap / (area1 * (area1 / area2)) >= this.REGIONS_OVERLAP) &&\r\n            (overlap / (area2 * (area1 / area2)) >= this.REGIONS_OVERLAP)) {\r\n            disjointSet.union(i, j);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    var map = {};\r\n    for (var k = 0; k < disjointSet.length; k++) {\r\n      var rep = disjointSet.find(k);\r\n      if (!map[rep]) {\r\n        map[rep] = {\r\n          total: 1,\r\n          width: rects[k].width,\r\n          height: rects[k].height,\r\n          x: rects[k].x,\r\n          y: rects[k].y\r\n        };\r\n        continue;\r\n      }\r\n      map[rep].total++;\r\n      map[rep].width += rects[k].width;\r\n      map[rep].height += rects[k].height;\r\n      map[rep].x += rects[k].x;\r\n      map[rep].y += rects[k].y;\r\n    }\r\n\r\n    var result = [];\r\n    Object.keys(map).forEach(function(key) {\r\n      var rect = map[key];\r\n      result.push({\r\n        total: rect.total,\r\n        width: (rect.width / rect.total + 0.5) | 0,\r\n        height: (rect.height / rect.total + 0.5) | 0,\r\n        x: (rect.x / rect.total + 0.5) | 0,\r\n        y: (rect.y / rect.total + 0.5) | 0\r\n      });\r\n    });\r\n\r\n    return result;\r\n  };\r\n\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * Brief intends for \"Binary Robust Independent Elementary Features\".This\r\n   * method generates a binary string for each keypoint found by an extractor\r\n   * method.\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.Brief = {};\r\n\r\n  /**\r\n   * The set of binary tests is defined by the nd (x,y)-location pairs\r\n   * uniquely chosen during the initialization. Values could vary between N =\r\n   * 128,256,512. N=128 yield good compromises between speed, storage\r\n   * efficiency, and recognition rate.\r\n   * @type {number}\r\n   */\r\n  tracking.Brief.N = 512;\r\n\r\n  /**\r\n   * Caches coordinates values of (x,y)-location pairs uniquely chosen during\r\n   * the initialization.\r\n   * @type {Object.<number, Int32Array>}\r\n   * @private\r\n   * @static\r\n   */\r\n  tracking.Brief.randomImageOffsets_ = {};\r\n\r\n  /**\r\n   * Caches delta values of (x,y)-location pairs uniquely chosen during\r\n   * the initialization.\r\n   * @type {Int32Array}\r\n   * @private\r\n   * @static\r\n   */\r\n  tracking.Brief.randomWindowOffsets_ = null;\r\n\r\n  /**\r\n   * Generates a binary string for each found keypoints extracted using an\r\n   * extractor method.\r\n   * @param {array} The grayscale pixels in a linear [p1,p2,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {array} keypoints\r\n   * @return {Int32Array} Returns an array where for each four sequence int\r\n   *     values represent the descriptor binary string (128 bits) necessary\r\n   *     to describe the corner, e.g. [0,0,0,0, 0,0,0,0, ...].\r\n   * @static\r\n   */\r\n  tracking.Brief.getDescriptors = function(pixels, width, keypoints) {\r\n    // Optimizing divide by 32 operation using binary shift\r\n    // (this.N >> 5) === this.N/32.\r\n    var descriptors = new Int32Array((keypoints.length >> 1) * (this.N >> 5));\r\n    var descriptorWord = 0;\r\n    var offsets = this.getRandomOffsets_(width);\r\n    var position = 0;\r\n\r\n    for (var i = 0; i < keypoints.length; i += 2) {\r\n      var w = width * keypoints[i + 1] + keypoints[i];\r\n\r\n      var offsetsPosition = 0;\r\n      for (var j = 0, n = this.N; j < n; j++) {\r\n        if (pixels[offsets[offsetsPosition++] + w] < pixels[offsets[offsetsPosition++] + w]) {\r\n          // The bit in the position `j % 32` of descriptorWord should be set to 1. We do\r\n          // this by making an OR operation with a binary number that only has the bit\r\n          // in that position set to 1. That binary number is obtained by shifting 1 left by\r\n          // `j % 32` (which is the same as `j & 31` left) positions.\r\n          descriptorWord |= 1 << (j & 31);\r\n        }\r\n\r\n        // If the next j is a multiple of 32, we will need to use a new descriptor word to hold\r\n        // the next results.\r\n        if (!((j + 1) & 31)) {\r\n          descriptors[position++] = descriptorWord;\r\n          descriptorWord = 0;\r\n        }\r\n      }\r\n    }\r\n\r\n    return descriptors;\r\n  };\r\n\r\n  /**\r\n   * Matches sets of features {mi} and {mj} extracted from two images taken\r\n   * from similar, and often successive, viewpoints. A classical procedure\r\n   * runs as follows. For each point {mi} in the first image, search in a\r\n   * region of the second image around location {mi} for point {mj}. The\r\n   * search is based on the similarity of the local image windows, also known\r\n   * as kernel windows, centered on the points, which strongly characterizes\r\n   * the points when the images are sufficiently close. Once each keypoint is\r\n   * described with its binary string, they need to be compared with the\r\n   * closest matching point. Distance metric is critical to the performance of\r\n   * in- trusion detection systems. Thus using binary strings reduces the size\r\n   * of the descriptor and provides an interesting data structure that is fast\r\n   * to operate whose similarity can be measured by the Hamming distance.\r\n   * @param {array} keypoints1\r\n   * @param {array} descriptors1\r\n   * @param {array} keypoints2\r\n   * @param {array} descriptors2\r\n   * @return {Int32Array} Returns an array where the index is the corner1\r\n   *     index coordinate, and the value is the corresponding match index of\r\n   *     corner2, e.g. keypoints1=[x0,y0,x1,y1,...] and\r\n   *     keypoints2=[x'0,y'0,x'1,y'1,...], if x0 matches x'1 and x1 matches x'0,\r\n   *     the return array would be [3,0].\r\n   * @static\r\n   */\r\n  tracking.Brief.match = function(keypoints1, descriptors1, keypoints2, descriptors2) {\r\n    var len1 = keypoints1.length >> 1;\r\n    var len2 = keypoints2.length >> 1;\r\n    var matches = new Array(len1);\r\n\r\n    for (var i = 0; i < len1; i++) {\r\n      var min = Infinity;\r\n      var minj = 0;\r\n      for (var j = 0; j < len2; j++) {\r\n        var dist = 0;\r\n        // Optimizing divide by 32 operation using binary shift\r\n        // (this.N >> 5) === this.N/32.\r\n        for (var k = 0, n = this.N >> 5; k < n; k++) {\r\n          dist += tracking.Math.hammingWeight(descriptors1[i * n + k] ^ descriptors2[j * n + k]);\r\n        }\r\n        if (dist < min) {\r\n          min = dist;\r\n          minj = j;\r\n        }\r\n      }\r\n      matches[i] = {\r\n        index1: i,\r\n        index2: minj,\r\n        keypoint1: [keypoints1[2 * i], keypoints1[2 * i + 1]],\r\n        keypoint2: [keypoints2[2 * minj], keypoints2[2 * minj + 1]],\r\n        confidence: 1 - min / this.N\r\n      };\r\n    }\r\n\r\n    return matches;\r\n  };\r\n\r\n  /**\r\n   * Removes matches outliers by testing matches on both directions.\r\n   * @param {array} keypoints1\r\n   * @param {array} descriptors1\r\n   * @param {array} keypoints2\r\n   * @param {array} descriptors2\r\n   * @return {Int32Array} Returns an array where the index is the corner1\r\n   *     index coordinate, and the value is the corresponding match index of\r\n   *     corner2, e.g. keypoints1=[x0,y0,x1,y1,...] and\r\n   *     keypoints2=[x'0,y'0,x'1,y'1,...], if x0 matches x'1 and x1 matches x'0,\r\n   *     the return array would be [3,0].\r\n   * @static\r\n   */\r\n  tracking.Brief.reciprocalMatch = function(keypoints1, descriptors1, keypoints2, descriptors2) {\r\n    var matches = [];\r\n    if (keypoints1.length === 0 || keypoints2.length === 0) {\r\n      return matches;\r\n    }\r\n\r\n    var matches1 = tracking.Brief.match(keypoints1, descriptors1, keypoints2, descriptors2);\r\n    var matches2 = tracking.Brief.match(keypoints2, descriptors2, keypoints1, descriptors1);\r\n    for (var i = 0; i < matches1.length; i++) {\r\n      if (matches2[matches1[i].index2].index2 === i) {\r\n        matches.push(matches1[i]);\r\n      }\r\n    }\r\n    return matches;\r\n  };\r\n\r\n  /**\r\n   * Gets the coordinates values of (x,y)-location pairs uniquely chosen\r\n   * during the initialization.\r\n   * @return {array} Array with the random offset values.\r\n   * @private\r\n   */\r\n  tracking.Brief.getRandomOffsets_ = function(width) {\r\n    if (!this.randomWindowOffsets_) {\r\n      var windowPosition = 0;\r\n      var windowOffsets = new Int32Array(4 * this.N);\r\n      for (var i = 0; i < this.N; i++) {\r\n        windowOffsets[windowPosition++] = Math.round(tracking.Math.uniformRandom(-15, 16));\r\n        windowOffsets[windowPosition++] = Math.round(tracking.Math.uniformRandom(-15, 16));\r\n        windowOffsets[windowPosition++] = Math.round(tracking.Math.uniformRandom(-15, 16));\r\n        windowOffsets[windowPosition++] = Math.round(tracking.Math.uniformRandom(-15, 16));\r\n      }\r\n      this.randomWindowOffsets_ = windowOffsets;\r\n    }\r\n\r\n    if (!this.randomImageOffsets_[width]) {\r\n      var imagePosition = 0;\r\n      var imageOffsets = new Int32Array(2 * this.N);\r\n      for (var j = 0; j < this.N; j++) {\r\n        imageOffsets[imagePosition++] = this.randomWindowOffsets_[4 * j] * width + this.randomWindowOffsets_[4 * j + 1];\r\n        imageOffsets[imagePosition++] = this.randomWindowOffsets_[4 * j + 2] * width + this.randomWindowOffsets_[4 * j + 3];\r\n      }\r\n      this.randomImageOffsets_[width] = imageOffsets;\r\n    }\r\n\r\n    return this.randomImageOffsets_[width];\r\n  };\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * FAST intends for \"Features from Accelerated Segment Test\". This method\r\n   * performs a point segment test corner detection. The segment test\r\n   * criterion operates by considering a circle of sixteen pixels around the\r\n   * corner candidate p. The detector classifies p as a corner if there exists\r\n   * a set of n contiguous pixelsin the circle which are all brighter than the\r\n   * intensity of the candidate pixel Ip plus a threshold t, or all darker\r\n   * than Ip  t.\r\n   *\r\n   *       15 00 01\r\n   *    14          02\r\n   * 13                03\r\n   * 12       []       04\r\n   * 11                05\r\n   *    10          06\r\n   *       09 08 07\r\n   *\r\n   * For more reference:\r\n   * http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.60.3991&rep=rep1&type=pdf\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.Fast = {};\r\n\r\n  /**\r\n   * Holds the threshold to determine whether the tested pixel is brighter or\r\n   * darker than the corner candidate p.\r\n   * @type {number}\r\n   * @default 40\r\n   * @static\r\n   */\r\n  tracking.Fast.THRESHOLD = 40;\r\n\r\n  /**\r\n   * Caches coordinates values of the circle surrounding the pixel candidate p.\r\n   * @type {Object.<number, Int32Array>}\r\n   * @private\r\n   * @static\r\n   */\r\n  tracking.Fast.circles_ = {};\r\n\r\n  /**\r\n   * Finds corners coordinates on the graysacaled image.\r\n   * @param {array} The grayscale pixels in a linear [p1,p2,...] array.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {number} threshold to determine whether the tested pixel is brighter or\r\n   *     darker than the corner candidate p. Default value is 40.\r\n   * @return {array} Array containing the coordinates of all found corners,\r\n   *     e.g. [x0,y0,x1,y1,...], where P(x0,y0) represents a corner coordinate.\r\n   * @static\r\n   */\r\n  tracking.Fast.findCorners = function(pixels, width, height, opt_threshold) {\r\n    var circleOffsets = this.getCircleOffsets_(width);\r\n    var circlePixels = new Int32Array(16);\r\n    var corners = [];\r\n\r\n    if (opt_threshold === undefined) {\r\n      opt_threshold = this.THRESHOLD;\r\n    }\r\n\r\n    // When looping through the image pixels, skips the first three lines from\r\n    // the image boundaries to constrain the surrounding circle inside the image\r\n    // area.\r\n    for (var i = 3; i < height - 3; i++) {\r\n      for (var j = 3; j < width - 3; j++) {\r\n        var w = i * width + j;\r\n        var p = pixels[w];\r\n\r\n        // Loops the circle offsets to read the pixel value for the sixteen\r\n        // surrounding pixels.\r\n        for (var k = 0; k < 16; k++) {\r\n          circlePixels[k] = pixels[w + circleOffsets[k]];\r\n        }\r\n\r\n        if (this.isCorner(p, circlePixels, opt_threshold)) {\r\n          // The pixel p is classified as a corner, as optimization increment j\r\n          // by the circle radius 3 to skip the neighbor pixels inside the\r\n          // surrounding circle. This can be removed without compromising the\r\n          // result.\r\n          corners.push(j, i);\r\n          j += 3;\r\n        }\r\n      }\r\n    }\r\n\r\n    return corners;\r\n  };\r\n\r\n  /**\r\n   * Checks if the circle pixel is brighter than the candidate pixel p by\r\n   * a threshold.\r\n   * @param {number} circlePixel The circle pixel value.\r\n   * @param {number} p The value of the candidate pixel p.\r\n   * @param {number} threshold\r\n   * @return {Boolean}\r\n   * @static\r\n   */\r\n  tracking.Fast.isBrighter = function(circlePixel, p, threshold) {\r\n    return circlePixel - p > threshold;\r\n  };\r\n\r\n  /**\r\n   * Checks if the circle pixel is within the corner of the candidate pixel p\r\n   * by a threshold.\r\n   * @param {number} p The value of the candidate pixel p.\r\n   * @param {number} circlePixel The circle pixel value.\r\n   * @param {number} threshold\r\n   * @return {Boolean}\r\n   * @static\r\n   */\r\n  tracking.Fast.isCorner = function(p, circlePixels, threshold) {\r\n    if (this.isTriviallyExcluded(circlePixels, p, threshold)) {\r\n      return false;\r\n    }\r\n\r\n    for (var x = 0; x < 16; x++) {\r\n      var darker = true;\r\n      var brighter = true;\r\n\r\n      for (var y = 0; y < 9; y++) {\r\n        var circlePixel = circlePixels[(x + y) & 15];\r\n\r\n        if (!this.isBrighter(p, circlePixel, threshold)) {\r\n          brighter = false;\r\n          if (darker === false) {\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (!this.isDarker(p, circlePixel, threshold)) {\r\n          darker = false;\r\n          if (brighter === false) {\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (brighter || darker) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  /**\r\n   * Checks if the circle pixel is darker than the candidate pixel p by\r\n   * a threshold.\r\n   * @param {number} circlePixel The circle pixel value.\r\n   * @param {number} p The value of the candidate pixel p.\r\n   * @param {number} threshold\r\n   * @return {Boolean}\r\n   * @static\r\n   */\r\n  tracking.Fast.isDarker = function(circlePixel, p, threshold) {\r\n    return p - circlePixel > threshold;\r\n  };\r\n\r\n  /**\r\n   * Fast check to test if the candidate pixel is a trivially excluded value.\r\n   * In order to be a corner, the candidate pixel value should be darker or\r\n   * brighter than 9-12 surrounding pixels, when at least three of the top,\r\n   * bottom, left and right pixels are brighter or darker it can be\r\n   * automatically excluded improving the performance.\r\n   * @param {number} circlePixel The circle pixel value.\r\n   * @param {number} p The value of the candidate pixel p.\r\n   * @param {number} threshold\r\n   * @return {Boolean}\r\n   * @static\r\n   * @protected\r\n   */\r\n  tracking.Fast.isTriviallyExcluded = function(circlePixels, p, threshold) {\r\n    var count = 0;\r\n    var circleBottom = circlePixels[8];\r\n    var circleLeft = circlePixels[12];\r\n    var circleRight = circlePixels[4];\r\n    var circleTop = circlePixels[0];\r\n\r\n    if (this.isBrighter(circleTop, p, threshold)) {\r\n      count++;\r\n    }\r\n    if (this.isBrighter(circleRight, p, threshold)) {\r\n      count++;\r\n    }\r\n    if (this.isBrighter(circleBottom, p, threshold)) {\r\n      count++;\r\n    }\r\n    if (this.isBrighter(circleLeft, p, threshold)) {\r\n      count++;\r\n    }\r\n\r\n    if (count < 3) {\r\n      count = 0;\r\n      if (this.isDarker(circleTop, p, threshold)) {\r\n        count++;\r\n      }\r\n      if (this.isDarker(circleRight, p, threshold)) {\r\n        count++;\r\n      }\r\n      if (this.isDarker(circleBottom, p, threshold)) {\r\n        count++;\r\n      }\r\n      if (this.isDarker(circleLeft, p, threshold)) {\r\n        count++;\r\n      }\r\n      if (count < 3) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  /**\r\n   * Gets the sixteen offset values of the circle surrounding pixel.\r\n   * @param {number} width The image width.\r\n   * @return {array} Array with the sixteen offset values of the circle\r\n   *     surrounding pixel.\r\n   * @private\r\n   */\r\n  tracking.Fast.getCircleOffsets_ = function(width) {\r\n    if (this.circles_[width]) {\r\n      return this.circles_[width];\r\n    }\r\n\r\n    var circle = new Int32Array(16);\r\n\r\n    circle[0] = -width - width - width;\r\n    circle[1] = circle[0] + 1;\r\n    circle[2] = circle[1] + width + 1;\r\n    circle[3] = circle[2] + width + 1;\r\n    circle[4] = circle[3] + width;\r\n    circle[5] = circle[4] + width;\r\n    circle[6] = circle[5] + width - 1;\r\n    circle[7] = circle[6] + width - 1;\r\n    circle[8] = circle[7] - 1;\r\n    circle[9] = circle[8] - 1;\r\n    circle[10] = circle[9] - width - 1;\r\n    circle[11] = circle[10] - width - 1;\r\n    circle[12] = circle[11] - width;\r\n    circle[13] = circle[12] - width;\r\n    circle[14] = circle[13] - width + 1;\r\n    circle[15] = circle[14] - width + 1;\r\n\r\n    this.circles_[width] = circle;\r\n    return circle;\r\n  };\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * Math utility.\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.Math = {};\r\n\r\n  /**\r\n   * Euclidean distance between two points P(x0, y0) and P(x1, y1).\r\n   * @param {number} x0 Horizontal coordinate of P0.\r\n   * @param {number} y0 Vertical coordinate of P0.\r\n   * @param {number} x1 Horizontal coordinate of P1.\r\n   * @param {number} y1 Vertical coordinate of P1.\r\n   * @return {number} The euclidean distance.\r\n   */\r\n  tracking.Math.distance = function(x0, y0, x1, y1) {\r\n    var dx = x1 - x0;\r\n    var dy = y1 - y0;\r\n\r\n    return Math.sqrt(dx * dx + dy * dy);\r\n  };\r\n\r\n  /**\r\n   * Calculates the Hamming weight of a string, which is the number of symbols that are\r\n   * different from the zero-symbol of the alphabet used. It is thus\r\n   * equivalent to the Hamming distance from the all-zero string of the same\r\n   * length. For the most typical case, a string of bits, this is the number\r\n   * of 1's in the string.\r\n   *\r\n   * Example:\r\n   *\r\n   * <pre>\r\n   *  Binary string     Hamming weight\r\n   *   11101                 4\r\n   *   11101010              5\r\n   * </pre>\r\n   *\r\n   * @param {number} i Number that holds the binary string to extract the hamming weight.\r\n   * @return {number} The hamming weight.\r\n   */\r\n  tracking.Math.hammingWeight = function(i) {\r\n    i = i - ((i >> 1) & 0x55555555);\r\n    i = (i & 0x33333333) + ((i >> 2) & 0x33333333);\r\n\r\n    return ((i + (i >> 4) & 0xF0F0F0F) * 0x1010101) >> 24;\r\n  };\r\n\r\n  /**\r\n   * Generates a random number between [a, b] interval.\r\n   * @param {number} a\r\n   * @param {number} b\r\n   * @return {number}\r\n   */\r\n  tracking.Math.uniformRandom = function(a, b) {\r\n    return a + Math.random() * (b - a);\r\n  };\r\n\r\n  /**\r\n   * Tests if a rectangle intersects with another.\r\n   *\r\n   *  <pre>\r\n   *  x0y0 --------       x2y2 --------\r\n   *      |       |           |       |\r\n   *      -------- x1y1       -------- x3y3\r\n   * </pre>\r\n   *\r\n   * @param {number} x0 Horizontal coordinate of P0.\r\n   * @param {number} y0 Vertical coordinate of P0.\r\n   * @param {number} x1 Horizontal coordinate of P1.\r\n   * @param {number} y1 Vertical coordinate of P1.\r\n   * @param {number} x2 Horizontal coordinate of P2.\r\n   * @param {number} y2 Vertical coordinate of P2.\r\n   * @param {number} x3 Horizontal coordinate of P3.\r\n   * @param {number} y3 Vertical coordinate of P3.\r\n   * @return {boolean}\r\n   */\r\n  tracking.Math.intersectRect = function(x0, y0, x1, y1, x2, y2, x3, y3) {\r\n    return !(x2 > x1 || x3 < x0 || y2 > y1 || y3 < y0);\r\n  };\r\n\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * Matrix utility.\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.Matrix = {};\r\n\r\n  /**\r\n   * Loops the array organized as major-row order and executes `fn` callback\r\n   * for each iteration. The `fn` callback receives the following parameters:\r\n   * `(r,g,b,a,index,i,j)`, where `r,g,b,a` represents the pixel color with\r\n   * alpha channel, `index` represents the position in the major-row order\r\n   * array and `i,j` the respective indexes positions in two dimensions.\r\n   * @param {array} pixels The pixels in a linear [r,g,b,a,...] array to loop\r\n   *     through.\r\n   * @param {number} width The image width.\r\n   * @param {number} height The image height.\r\n   * @param {function} fn The callback function for each pixel.\r\n   * @param {number} opt_jump Optional jump for the iteration, by default it\r\n   *     is 1, hence loops all the pixels of the array.\r\n   * @static\r\n   */\r\n  tracking.Matrix.forEach = function(pixels, width, height, fn, opt_jump) {\r\n    opt_jump = opt_jump || 1;\r\n    for (var i = 0; i < height; i += opt_jump) {\r\n      for (var j = 0; j < width; j += opt_jump) {\r\n        var w = i * width * 4 + j * 4;\r\n        fn.call(this, pixels[w], pixels[w + 1], pixels[w + 2], pixels[w + 3], w, i, j);\r\n      }\r\n    }\r\n  };\r\n\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * EPnp utility.\r\n   * @static\r\n   * @constructor\r\n   */\r\n  tracking.EPnP = {};\r\n\r\n  tracking.EPnP.solve = function(objectPoints, imagePoints, cameraMatrix) {};\r\n}());\r\n\r\n(function() {\r\n  /**\r\n   * Glorious-Dawn: custom additional initialization   *\r\n   */\r\n  tracking.Fast.THRESHOLD=20;\r\n  tracking.Brief.randomWindowOffsets_=Int32Array.from([4,0,-7,-4,-2,5,4,7,2,-10,15,-11,6,-6,0,7,11,-9,-6,6,-5,14,9,-14,-9,-5,-6,-2,1,-1,13,-1,-2,-6,11,-10,-1,-11,-3,4,12,1,11,13,3,-13,7,8,3,14,-15,3,9,-2,10,-5,-1,3,10,7,13,-10,-8,1,-7,10,-11,8,-6,15,4,15,-4,6,14,-10,9,-5,0,11,-13,-7,-15,11,14,6,3,6,-3,-13,10,-3,-4,3,-8,12,-14,11,-14,1,-6,-2,3,14,10,14,4,13,10,15,2,5,1,1,9,-8,-10,13,-15,-9,-14,-7,9,7,-9,7,12,2,10,-14,7,0,-10,6,-15,-13,1,11,6,-8,8,-12,9,14,1,15,5,-10,2,3,9,8,-2,-4,13,-5,-8,0,-7,-3,13,-11,-7,10,13,-3,8,2,4,13,12,7,-6,4,15,1,-11,6,15,11,-5,-5,-1,-15,11,9,9,11,-5,-3,-7,-5,0,-8,1,-6,-4,-10,-5,1,0,15,15,-12,-11,-10,-6,12,10,-6,-8,0,6,-4,-7,-9,3,-9,-15,8,-7,-11,-2,7,-4,8,7,8,-3,5,4,-4,-9,4,5,-1,-7,-1,11,-5,-5,14,5,13,-14,13,6,-9,11,4,16,-7,-9,13,-15,-15,-2,10,-4,13,-11,15,11,6,10,-14,0,5,-12,1,-3,-10,0,3,10,-5,9,-9,10,1,-7,-13,-10,9,-5,-3,-4,-12,-13,-8,13,11,2,15,7,-9,-3,-5,0,13,12,2,-11,-8,-2,-9,14,-3,-11,8,-4,14,-4,12,4,-4,-13,5,3,2,4,-2,-6,-2,-5,14,3,-11,-1,2,-7,-6,-11,-7,11,3,-10,2,-11,14,8,-11,4,-2,4,3,1,-15,6,4,2,-4,0,0,4,-9,-8,11,3,-3,-11,-13,9,2,-8,3,15,15,0,7,-12,13,-4,5,10,-9,2,-2,-11,-5,-4,-5,-9,14,7,-2,-7,-2,10,-3,-1,2,-15,-13,14,8,-14,-10,-14,-14,5,13,-2,1,6,7,12,5,-2,-11,-7,-1,13,-9,10,16,-6,-12,4,-10,-8,-1,-13,16,6,8,-13,-4,13,1,-10,-6,13,-12,15,-5,-9,10,-3,4,7,2,-7,9,-1,7,-2,9,-5,2,11,1,12,-9,-5,-9,-5,9,-2,11,10,-11,-5,2,15,-9,-14,2,-15,-15,-6,14,-11,-3,-6,-6,-9,-9,-9,-13,12,-3,-14,-14,0,16,-12,6,0,-12,-12,15,-2,5,4,-1,-8,9,-5,-8,-6,-1,-12,15,-11,11,-9,9,-2,-15,-8,-5,-1,-12,4,-2,14,-10,8,-3,-13,3,-13,-5,15,2,14,9,-13,5,0,4,-8,4,7,5,3,-11,-3,2,6,0,-2,-11,1,13,-4,9,-2,-11,13,6,-2,-9,-2,1,14,4,15,12,12,3,8,15,-14,-6,16,-13,-10,-13,0,-13,-5,-2,-4,4,-2,14,-3,-4,5,14,9,0,14,12,9,14,7,-2,-12,12,-11,4,1,2,0,-9,-10,8,15,7,-10,10,13,-12,-6,10,2,15,3,15,5,0,-3,10,1,16,-2,-4,-3,13,13,2,8,-1,-5,15,5,1,3,11,-6,0,14,11,-2,-9,6,-5,11,10,-6,15,7,10,-9,-8,-10,-8,-15,-12,-9,6,-2,-14,8,5,4,-4,-4,14,-7,10,5,-14,-6,7,12,3,12,4,-3,-14,7,-8,-7,-1,3,4,-11,-12,10,12,-4,2,-15,-14,7,12,5,10,9,-14,-9,-12,-10,12,5,13,8,-13,2,-8,7,-8,5,-11,-1,5,4,-9,5,-12,-5,7,-2,8,0,10,16,-11,-4,-2,12,13,6,2,12,6,10,10,-6,-14,-4,-6,-7,-11,1,-12,-4,11,9,7,-1,6,-4,-11,3,-4,-5,-2,14,-14,-11,5,2,8,13,-11,13,6,-12,2,7,11,11,5,-4,7,-13,-9,10,0,-3,11,-8,-9,16,4,9,9,-14,9,-14,-1,-10,-7,-12,-6,12,3,-5,9,16,8,0,4,-6,12,13,15,14,9,9,-8,-13,1,12,-11,-2,10,9,-11,-9,4,13,15,-5,8,11,10,-10,-12,1,14,-9,2,-6,2,-9,12,-9,-4,-3,-6,-14,4,-11,-13,11,12,6,14,-12,15,-2,7,-15,1,4,-8,2,13,0,6,3,12,-4,-6,-8,7,14,0,-1,-3,-6,12,-2,-15,-4,-13,-11,8,-8,6,7,-2,-13,8,0,-5,-4,0,10,-13,10,5,16,-6,14,3,12,3,9,10,8,-1,0,-9,10,-6,9,11,6,13,3,9,15,9,-11,-2,6,7,-3,-13,16,4,-14,-7,-11,-11,6,9,-8,-15,-2,8,-7,3,15,3,5,-3,11,2,-15,8,10,-12,5,15,5,15,-1,3,-10,11,-5,7,-6,-5,-5,-7,-6,7,-6,14,13,-7,-2,-15,3,-13,-2,-8,-8,6,0,14,-15,12,-11,-1,1,-1,2,15,1,-11,4,-9,13,-6,12,5,8,-1,-8,-11,5,8,14,-4,5,3,-14,-1,-12,-11,-7,1,5,14,-8,3,-2,8,14,0,-7,-4,-4,12,0,10,1,-15,-14,10,-1,4,11,-12,-11,11,-4,8,-3,4,4,-10,10,-14,0,-12,15,-10,-8,4,-10,16,14,13,0,-4,-2,-9,-9,-1,2,16,11,8,-14,7,-7,8,-5,-5,5,5,-10,7,11,-5,8,-5,-11,0,-1,-11,10,6,8,-9,8,14,11,0,6,8,15,-3,-15,5,5,12,7,-13,-12,-1,0,16,5,-3,-7,0,10,8,-6,-2,8,-13,13,1,14,-5,1,2,-9,-13,3,-10,15,2,16,6,-8,15,-8,4,8,-5,-2,5,14,10,7,3,-6,-3,3,-13,-3,-14,1,-12,13,15,3,7,-9,4,-8,10,-13,-3,-3,-1,-6,-14,-11,-6,4,-11,12,-8,1,2,10,1,-2,-8,2,-13,14,1,4,0,8,15,-1,4,0,-7,-3,16,8,0,9,0,-4,-2,-2,7,4,-9,15,-7,14,2,-8,7,-13,-6,1,12,-8,-7,3,-2,13,-14,10,-14,2,-13,-1,-4,9,-3,15,-11,-6,10,-4,-14,-4,6,-3,-11,-9,-1,-7,3,-3,3,0,12,6,5,-10,10,-14,-12,-4,8,-7,11,5,15,14,-4,4,-5,-11,-7,1,-6,-13,-7,-12,10,13,-13,14,7,-13,-8,11,5,12,-6,-11,-13,-12,-5,12,13,-5,-5,-11,-2,6,8,-1,-10,6,6,14,3,5,3,-14,-12,1,-12,14,13,-4,10,7,13,-15,-8,-7,-14,8,12,-2,-15,10,12,-9,1,0,2,12,8,4,-10,-13,-12,-4,-9,16,-6,-4,-8,6,-6,-9,-10,2,1,6,3,-8,-6,1,6,13,16,-15,15,14,0,10,-5,16,11,-2,15,2,1,7,-6,-8,12,9,12,9,-9,-4,-11,-13,-14,3,1,-3,-11,13,-8,0,3,12,-4,6,15,1,-12,-4,14,-2,11,3,4,1,7,1,2,14,-5,-8,0,-3,-8,-4,-14,11,-12,-14,2,5,15,1,11,2,9,-15,9,4,6,-3,-5,-10,-9,-8,11,13,8,16,3,9,15,9,-1,-12,-2,-7,-10,-6,-7,15,-13,-13,6,6,11,14,-15,14,15,6,0,-7,-9,6,-5,-11,-12,-4,-11,-9,-1,-9,-14,16,16,3,-4,11,10,-3,13,-13,0,8,0,-6,13,-5,14,3,-10,-3,11,-9,8,-12,-8,12,5,-12,-13,5,-14,-8,-5,-12,-6,-12,0,1,-9,-5,7,2,11,-3,-6,7,0,9,-7,12,3,-7,15,4,1,-10,9,-12,-10,2,16,0,15,-14,-6,14,-3,-7,-8,4,-7,-6,-10,-1,-2,-10,13,14,0,-3,11,-6,-14,-11,6,7,-3,14,-15,7,-6,6,-8,-8,11,-1,10,-5,-14,16,-11,-6,-15,15,-14,-12,4,11,-9,-3,-3,-3,14,16,-15,13,13,10,5,14,6,-4,5,11,1,-15,8,4,0,-12,-3,4,12,14,3,-7,-4,1,14,13,-9,2,16,12,1,5,-4,3,13,-2,12,-11,-2,5,13,-3,2,14,-3,-3,0,0,-1,-9,2,-13,-3,-5,6,-6,15,12,2,-13,1,-6,-10,5,3,9,-14,-13,-5,-3,6,1,-8,12,-2,13,12,-13,-13,6,-11,5,-3,4,2,5,-13,-12,-8,-8,-7,-10,-3,-12,15,-8,2,14,-13,7,-4,10,-1,8,-10,1,4,16,11,8,13,7,-12,8,-11,7,-15,-3,-5,3,-6,-6,4,6,6,13,3,-8,3,2,-6,2,-3,5,-12,3,-2,4,8,-10,-8,-3,-1,-4,-8,6,-6,2,4,3,-9,5,12,-9,-1,2,13,-11,9,7,-8,5,12,-2,7,-2,3,-14,-2,-14,5,-12,-10,7,-8,-10,-6,13,12,-10,5,10,-9,-12,3,10,-6,-6,5,-5,-6,-9,1,-8,-15,1,-13,-3,6,10,3,1,15,-9,3,-4,16,13,-2,-12,13,-6,11,2,-4,10,-5,-2,-15,3,-11,-13,5,-5,16,-3,10,15,9,5,9,8,0,-3,3,5,14,0,8,15,10,9,11,6,-14,-10,3,-3,10,-2,-14,-14,-5,12,0,3,4,-3,2,-12,-7,12,-12,-2,-1,-11,6,3,9,9,-8,-11,14,-6,15,3,-7,2,-7,-10,11,-5,13,8,5,2,15,-5,-11,7,-8,-7,0,-1,-4,5,-7,1,14,1,11,12,7,4,0,-13,-10,-8,3,10,10,-13,-7,-15,-6,13,-1,-6,1,-2,12,-3,14,15,-10,5,9,-3,12,10,-1,0,14,6,-6,11,7,9,-11,-3,-13,11,-5,0,-7,-6,-9,-8,-1,-4,-14,-9,-2,16,14,-15,14,4,0,11,-13,12,2,6,14,0,3,12,13,12,-6,-10,-12,-3,0,10,-12,-12,-13,-10,-12,-10,-2,5,-6,-4,-11,-15,-14,-6,2,-10,12,1,15,16,-6,6,2,11,5,0,9,-4,16,-15,8,13,11,10,-1,14,11,-7,13,0,11,8,-4,-9,-14,14,-14,5,16,-15,11,-3,8,10,-14,9,-14,10,-14,10,6,-9,10,8,7,-9,-9,15,-14,0,14,8,-9,5,13,0,0,-7,0,-11,2,9,-8,7,-9,-7,13,-12,10,4,14,7,7,12,-15,16,-4,-14,-12,8,5,8,-4,12,1,2,-13,3,-4,-2,-5]);\r\n\r\n  // Used to eliminate the randomness when feature extractor needs to be stored and reused\r\n  tracking.Brief.setRandomWindowOffsets=function(windowOffsets){\r\n    this.randomImageOffsets_={};\r\n    this.randomWindowOffsets_=Int32Array.from(windowOffsets);\r\n  };\r\n\r\n  tracking.Brief.generateRandomWindowOffsets=function(){\r\n    var windowPosition = 0;\r\n    var windowOffsets = new Int32Array(4 * this.N);\r\n    for (var i = 0; i < this.N; i++) {\r\n      windowOffsets[windowPosition++] = Math.round(tracking.Math.uniformRandom(-15, 16));\r\n      windowOffsets[windowPosition++] = Math.round(tracking.Math.uniformRandom(-15, 16));\r\n      windowOffsets[windowPosition++] = Math.round(tracking.Math.uniformRandom(-15, 16));\r\n      windowOffsets[windowPosition++] = Math.round(tracking.Math.uniformRandom(-15, 16));\r\n    }\r\n    return windowOffsets;\r\n  };\r\n\r\n}());\r\n\r\nmodule.exports=tracking;","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"6b51f71c40d54e09dcb6.worker.js\");\n};"],"sourceRoot":""}